!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).biliMediaPreview=t()}(this,(function(){"use strict";function e(e,t,i,n){return new(i||(i=Promise))((function(s,o){function r(e){try{a(n.next(e))}catch(e){o(e)}}function l(e){try{a(n.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,l)}a((n=n.apply(e,t||[])).next())}))}const t=e=>{let t;const i=new Set,n=(e,n)=>{const s="function"==typeof e?e(t):e;if(s!==t){const e=t;t=n?s:Object.assign({},t,s),i.forEach((i=>i(t,e)))}},s=()=>t,o={setState:n,getState:s,subscribe:e=>(i.add(e),()=>i.delete(e)),destroy:()=>i.clear()};return t=e(n,s,o),o},i=e=>e?t(e):t,n=e=>(t,i,n)=>{const s=n.subscribe;n.subscribe=(e,t,i)=>{let o=e;if(t){const s=(null==i?void 0:i.equalityFn)||Object.is;let r=e(n.getState());o=i=>{const n=e(i);if(!s(r,n)){const e=r;t(r=n,e)}},(null==i?void 0:i.fireImmediately)&&t(r,r)}return s(o)};return e(t,i,n)},s={displayZIndex:1e3,displayMode:"inline"},o=i(n((()=>Object.assign({},s)))),r={aid:0,bvid:"",cid:0,seasonId:0,episodeId:0,status:"unload",isProgressSliding:!1,isDmVisible:!0,progress:0,duration:0,spmIdFrom:"",ugcInfo:{}},l=i(n((()=>Object.assign({},r))));function a(){const e={};return e.promise=new Promise(((t,i)=>{e.resolve=t,e.reject=i})),e}const d={all:p=p||new Map,on:function(e,t){var i=p.get(e);i?i.push(t):p.set(e,[t])},off:function(e,t){var i=p.get(e);i&&(t?i.splice(i.indexOf(t)>>>0,1):p.set(e,[]))},emit:function(e,t){var i=p.get(e);i&&i.slice().map((function(e){e(t)})),(i=p.get("*"))&&i.slice().map((function(i){i(e,t)}))}};var p;const c=e=>"string"==typeof e,h=e=>"object"==typeof e,u=()=>"undefined"==typeof window,m=()=>{},v=e=>{try{return c(e)?document.querySelector(e):h(t=e)&&t.nodeType>0?e:null}catch(e){return null}var t},b=(e=0,t="YYYY-MM-DD")=>{const i=new Date(1e3*e),n=Math.floor((new Date).getTime()/1e3);if(n-e<=60)return"刚刚";if(n-e<3600)return Math.floor((n-e)/60)+"分钟前";if(n-e<86400)return Math.floor((n-e)/3600)+"小时前";const s=new Date;if(s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.getTime()/1e3-e<86400)return"昨天";const o=String(i.getFullYear()),r=String(i.getMonth()+1),l=String(i.getDate());return i.getFullYear()!==(new Date).getFullYear()?t.replace("YYYY",o).replace("MM",r).replace("DD",l):r+(t.split("MM")[1]||"").replace("DD",l)},g=(e=0)=>{if(e<0||null==e)return"--";if(-1!==String(e).indexOf(".")||-1!==String(e).indexOf("-"))return e.toString();if(0===e)return"0";return e>=1e4&&e<1e8?parseFloat(Number(e/1e4).toFixed(1))+"万":e>=1e8?parseFloat(Number(e/1e8).toFixed(1))+"亿":e.toString()},y=e=>{const{target:t,name:i,listener:n}=e;t.removeEventListener(i,n)},f=e=>{const{target:t,name:i,listener:n}=e;return t.addEventListener(i,n),()=>{y(e)}},C=e=>{for(let t=0;t<e.length;t++)f(e[t]);return()=>{(e=>{for(let t=0;t<e.length;t++)y(e[t])})(e)}},w=e=>!(!e.episodeId&&!e.seasonId),x=e=>encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]"),k=e=>{if(!e.url)return"";let t=e.url;const i={};let n="",s=[];if(t.indexOf("?")>-1){const e=t.split("?");t=e[0],n=e[1],s=n.split("&"),s.forEach((e=>{const t=e.split("=");2===t.length&&(i[t[0]]=t[1])}))}Object.assign(i,e.query),s=[];for(const e in i)void 0!==i[e]&&s.push(`${x(e)}=${x(String(i[e]))}`);return s.length?(n=s.join("&"),`${t}?${n}`):t};let L=null;const M=()=>e(void 0,void 0,void 0,(function*(){try{return window.nano||(L?yield L.promise:(L=a(),yield(e=>{try{const t=window.asyncScriptsQueue||new Map;return t[e]||(t[e]=new Promise(((t,i)=>{const n=document.createElement("script");n.src=e,n.onload=()=>{t(!0)},n.onerror=e=>{i(e)},document.body.appendChild(n)})),window.asyncScriptsQueue=t),t[e]}catch(e){return Promise.reject(e)}})(`//s1.hdslb.com/bfs/static/player/main/core.${""===window.__NANO_VERSION_HASH__?"":`${window.__NANO_VERSION_HASH__||"5b10aa04"}.`}js`),L.resolve(),L=null)),window.nano}catch(e){return null==L||L.reject(),Promise.reject(e)}})),E=e=>e.kind?e.kind:w(e)?"Pgc":"Ugc",P=t=>e(void 0,void 0,void 0,(function*(){var e,i;try{yield M();const n=window.nano;return n.createPlayer(Object.assign(Object.assign({},t),{kind:n.GroupKind[E(t)],muted:null===(e=t.muted)||void 0===e||e,autoplay:null!==(i=t.autoplay)&&void 0!==i&&i,channelKind:n.ChannelKind[t.channelKind||"Homepage"],quality:32,hideBoxShadow:!0,enableHEVC:!0,enableAV1:!0}))}catch(e){return Promise.reject(e)}}));let B="";const S=()=>{var e;if(u())return"";if(B)return B;try{return B=(null===(e=document.querySelector("meta[name=spm_prefix]"))||void 0===e?void 0:e.content)||"",B}catch(e){return""}},H=e=>{if(!e)return"";const t=S();return t?e.indexOf(t)>-1?e:`${t}.${e}`:""},_=(e,t,i,n)=>{var s,o,r,l;if(u())return;if(!window.reportConfig&&!window.MReporter)return;if(!e||!t)return;let a=null;if(!a&&window.reportConfig)if(window.reportMsgObj)a=window.reportMsgObj;else{const{msgObjects:e}=window.reportConfig;a=window[e]||null}const d=t.indexOf("selfDef");if(d>-1)return void(a&&(a[t.substring(d+8)]=i,null===(s=window.reportObserver)||void 0===s||s.forceCommit()));const p=S();if(!p)return;const c="object"==typeof i?JSON.stringify(i):JSON.stringify({});if(window.MReporter)return t.indexOf(p)>-1&&(t=t.replace(`${p}.`,"")),void(null===(r=(o=window.MReporter)[e])||void 0===r||r.call(o,{evt:t,msg:c,target_url:n||""}));null===(l=window.reportObserver)||void 0===l||l.reportCustomData(e,{spm_id:H(t),msg:c,target_url:n||""})},Z=e=>{let t="";const i=l.getState();if("video"===e){if(i.isProgressSliding)return;t=((e,t)=>{const i=`//www.bilibili.com/video/${e.bvid||`av${e.aid}`}`;return k({url:i,query:Object.assign({},t||{})})})({aid:i.aid,bvid:i.bvid},{t:i.progress?Math.round(i.progress):void 0}),((e,t)=>{t&&(e=k({url:e,query:{spm_id_from:H(t.name)||void 0}}),_("click",t.name,t.value,e)),window.open(e)})(t,{name:i.spmIdFrom,value:{mode:o.getState().displayMode,type:e}})}t&&d.emit("view-details",{aid:i.aid,url:t})},z=e=>e?e.replace(/^http:/,""):"";class T{constructor(e){this.name="",this.isUnmounted=!1,this.name=(null==e?void 0:e.name)||"",this.el=document.createElement((null==e?void 0:e.tag)||"div"),(null==e?void 0:e.className)&&(this.el.className=e.className),(null==e?void 0:e.parent)&&e.parent.getElement().appendChild(this.el)}get visible(){return"none"!==getComputedStyle(this.el).display}show(){this.el.style.display=""}hide(){this.el.style.display="none"}getElement(){return this.el}unmount(){var e;this.isUnmounted||(null===(e=this.el.parentElement)||void 0===e||e.removeChild(this.el),this.isUnmounted=!0)}}class I extends T{constructor(e){super({className:"bmp-media-player-container"}),this.el.id=e}}class A extends T{constructor(e){super({className:e.className}),this.clickHandler=null,this.clickHandler=e.clickHandler,this.onClick=t=>{t.stopPropagation(),e.clickHandler()},this.el.addEventListener("click",this.onClick)}handleClick(){var e;return null===(e=this.clickHandler)||void 0===e?void 0:e.call(this)}dispose(){this.clickHandler=null,this.el.removeEventListener("click",this.onClick),this.unmount()}}class j extends A{constructor(e){super({className:"bmp-media-ctrl-button",clickHandler:e.clickHandler}),e.className&&this.el.classList.add(e.className)}}class V extends A{constructor(e){super({className:"bmp-close-button",clickHandler:e})}}class N extends T{constructor(){super({className:"bmp-media-cover"})}load(e){const t=new Image;t.classList.add("bmp-media-cover-img"),t.onload=()=>{this.el.appendChild(t)},t.src=e}dispose(){this.unmount()}}class O extends T{constructor(e){super({className:"bmp-mask"}),this.removeEventListeners=m,this.opacity=(null==e?void 0:e.opacity)||.5,this.scrollingElement=v((null==e?void 0:e.scrollingElement)||"")||document.body,this.clickHandler=null==e?void 0:e.clickHandler,this.removeEventListeners=C([{target:this.el,name:"click",listener:e=>{var t;null===this.el.getAttribute("zooming")&&(e.stopPropagation(),null===(t=this.clickHandler)||void 0===t||t.call(this))}}])}show(){var e,t;const i=o.getState();i.displayZIndex&&this.el.style.setProperty("z-index",String(i.displayZIndex)),(null===(t=null===(e=i.popupOptions)||void 0===e?void 0:e.anime)||void 0===t?void 0:t.zoomOut)?this.setZoomInAnime():(this.el.setAttribute("active",""),this.scrollingElement.style.setProperty("overflow","hidden"))}hide(){var e,t;(null===(t=null===(e=o.getState().popupOptions)||void 0===e?void 0:e.anime)||void 0===t?void 0:t.zoomOut)?this.setZoomOutAnime():(this.el.removeAttribute("active"),this.scrollingElement.style.setProperty("overflow",""))}setZoomInAnime(){this.el.setAttribute("zooming",""),this.el.setAttribute("zoom-in-anime",""),this.el.setAttribute("active",""),this.scrollingElement.style.setProperty("overflow","hidden"),setTimeout((()=>{this.el.removeAttribute("zoom-in-anime"),this.el.removeAttribute("zooming")}),800)}setZoomOutAnime(){var e,t;this.el.setAttribute("zooming",""),null===(t=(e=this.el).setAttribute)||void 0===t||t.call(e,"zoom-out-anime",""),this.el.removeAttribute("active"),setTimeout((()=>{this.el.removeAttribute("zoom-out-anime"),this.el.removeAttribute("zooming"),this.scrollingElement.style.setProperty("overflow","")}),800)}dispose(){this.clickHandler=null,this.removeEventListeners(),this.unmount()}}class D extends T{constructor(e){super({className:"bmp-media-progress"}),e&&this.el.classList.add(e)}dispose(){this.unmount()}}class F extends T{constructor(e){const t="bmp-media-player-ctrl";super({className:t,name:t}),this.el.innerHTML=`\n      <div class="${this.name}-left"></div>\n      <div class="${this.name}-center"></div>\n      <div class="${this.name}-right"></div>\n    `,e.getElement().appendChild(this.el)}addCtrlButtonToLeft(e){const t=this.el.querySelector(`.${this.name}-left`);null==t||t.appendChild(e)}addCtrlButtonToRight(e){const t=this.el.querySelector(`.${this.name}-right`);null==t||t.appendChild(e)}addProgressBarToCenter(e){const t=this.el.querySelector(`.${this.name}-center`);null==t||t.appendChild(e)}dispose(){this.unmount()}}class $ extends T{constructor(){super({className:"bmp-media-player-panel"}),this.mediaPlayerCtrl=new F(this)}addCtrlButtonToPlayerCtrl(e,t){"left"===t?this.mediaPlayerCtrl.addCtrlButtonToLeft(e):this.mediaPlayerCtrl.addCtrlButtonToRight(e)}addProgressBar(e){this.mediaPlayerCtrl.addProgressBarToCenter(e)}dispose(){this.mediaPlayerCtrl.dispose(),this.unmount()}}class U extends T{constructor(){super(...arguments),this.content=""}setContent(e){this.content=e,this.el.innerText=e}}class R extends U{constructor(e,t){super(Object.assign(Object.assign({},e||{}),{tag:"a"})),this.url="",t||this.el.setAttribute("target","_blank")}setUrl(e){this.url=e,this.el.setAttribute("href",e)}}class q extends A{constructor(e){super({className:"bmp-link-button",clickHandler:e.clickHandler}),e.className&&this.el.classList.add(e.className)}setText(e){this.el.innerText=e}}class Y extends A{constructor(e){super({className:"bmp-media-container",clickHandler:()=>{Z(e)}}),this.mediaPlayerPanel=new $,this.mediaProgress=new D("bmp-media-progress-shadow"),this.mediaCover=new N,this.el.appendChild(this.mediaPlayerPanel.getElement()),this.el.appendChild(this.mediaProgress.getElement()),this.el.appendChild(this.mediaCover.getElement())}setTitle(e){this.el.setAttribute("aria-label",e)}dispose(){this.mediaPlayerPanel.dispose(),this.mediaProgress.dispose(),this.mediaCover.dispose(),this.unmount()}}class X extends T{constructor(e){super({className:"bmp-media-details"}),this.pubinfo=new R({className:"bmp-media-info-pub"}),this.statinfo=new U({className:"bmp-media-info-stat"}),this.title=new q({className:"bmp-media-title",clickHandler:()=>{Z(e)}}),this.el.appendChild(this.title.getElement());const t=document.createElement("div");this.el.appendChild(t),t.classList.add("bmp-media-info"),t.appendChild(this.pubinfo.getElement()),t.appendChild(this.statinfo.getElement())}setTitle(e){this.title.setText(e)}setPubinfo(e){this.pubinfo.setContent(e.content),this.pubinfo.setUrl(e.url)}setStatinfo(e){this.statinfo.setContent(e)}dispose(){this.title.unmount(),this.pubinfo.unmount(),this.statinfo.unmount(),this.unmount()}}class G extends T{constructor(){const e="bmp-media-end";super({className:e,name:e}),this.el.innerHTML=`\n      <div class="${e}-backdrop"></div>\n      <div class="${e}-panel">\n        <div class="${e}-functions"></div>\n        <div class="${e}-related"></div>\n      </div>\n    `}setBackDrop(e){if(e){this.el.querySelector(`.${this.name}-backdrop`).style.backgroundImage=`url(${e})`}}addButtonToFunctions(e){this.el.querySelector(`.${this.name}-functions`).appendChild(e)}addCardToRelated(e){this.el.querySelector(`${this.name}-related`).appendChild(e)}dispose(){this.unmount()}}class K extends T{constructor(){const e="bmp-fake-media-container";super({className:e,name:e})}setBackDrop(e){e&&(this.el.style.backgroundImage=`url(${e})`)}dispose(){this.unmount()}}const J='\n<svg width="32" height="20" viewBox="0 0 32 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g clip-path="url(#clip0_7936_315092)">\n<rect width="32" height="20" rx="10" fill="#0087BD"/>\n<g filter="url(#filter0_d_7936_315092)">\n<circle cx="22" cy="10" r="8" fill="white"/>\n</g>\n</g>\n<defs>\n<filter id="filter0_d_7936_315092" x="12" y="1" width="20" height="20" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="1"/>\n<feGaussianBlur stdDeviation="1"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_7936_315092"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_7936_315092" result="shape"/>\n</filter>\n<clipPath id="clip0_7936_315092">\n<rect width="32" height="20" rx="10" fill="white"/>\n</clipPath>\n</defs>\n</svg>\n';class W extends T{constructor(){super({className:"bmp-video-progress-track-bar"}),this.buffer=document.createElement("div"),this.percent=document.createElement("div"),this.buffer.className="bmp-video-progress-track-bar-buffer",this.percent.className="bmp-video-progress-track-bar-percent",this.el.appendChild(this.buffer),this.el.appendChild(this.percent)}update(e){this.percent.style.setProperty("transform",`scaleX(${e})`)}dispose(){this.unmount()}}class Q extends T{constructor(){super({className:"bmp-video-progress-track-thumb"}),this.dot=document.createElement("div"),this.dot.className="bmp-video-progress-track-thumb-dot",this.dot.innerHTML='<svg width="16" height="15" viewBox="0 0 16 15" fill="none" xmlns="http://www.w3.org/2000/svg">\n<rect x="1.125" y="3.625" width="13.75" height="10.75" rx="2.375" fill="white" stroke="#333333" stroke-width="1.25"/>\n<rect x="3.7998" y="7" width="1.8" height="4" rx="0.9" fill="#333333"/>\n<rect x="10.3999" y="7" width="1.8" height="4" rx="0.9" fill="#333333"/>\n<mask id="mask0_1405_177278" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="2" y="0" width="12" height="4">\n<rect x="2.6001" width="10.8" height="3.4" fill="white"/>\n</mask>\n<g mask="url(#mask0_1405_177278)">\n<rect x="2.6001" y="0.899902" width="1.8" height="4.53333" rx="0.9" transform="rotate(-30 2.6001 0.899902)" fill="#333333"/>\n<rect width="1.8" height="4.53333" rx="0.9" transform="matrix(-0.866025 -0.5 -0.5 0.866025 13.3999 0.899902)" fill="#333333"/>\n</g>\n</svg>\n',this.el.appendChild(this.dot)}update(e){this.el.style.setProperty("left",100*e+"%")}dispose(){this.unmount()}}class ee extends T{constructor(){super({className:"bmp-video-progress-track"}),this.bar=new W,this.thumb=new Q,this.el.appendChild(this.bar.getElement()),this.el.appendChild(this.thumb.getElement())}update(e){e=Math.max(0,Math.min(1,e)),this.bar.update(e),this.thumb.update(e)}dispose(){this.bar.dispose(),this.thumb.dispose()}}class te extends T{constructor(t){super({className:"bmp-video-progress-slider"}),this.progress=0,this.duration=0,this.sliding=!1,this.mousedownX=0,this.rect=null,this.track=new ee,this.el.appendChild(this.track.getElement()),this.el.setAttribute("aria-lable","进度条");const i=e=>{if(!this.rect)return;this.mousedownX=e;const t=(this.mousedownX-this.rect.x)/this.rect.width;this.track.update(t)};this.removeEventListeners=C([{target:this.el,name:"click",listener:e=>{e.stopPropagation(),e.preventDefault()}},{target:this.el,name:"mousedown",listener:e=>{e.preventDefault(),e.stopPropagation(),_("click","preview_player.progress.click",{mode:o.getState().displayMode,type:"video"}),this.duration&&(l.setState({isProgressSliding:!0}),this.rect=this.el.getBoundingClientRect(),i(e.pageX))}},{target:window,name:"mousemove",listener:e=>{this.sliding&&(e.preventDefault(),i(e.pageX))}},{target:window,name:"mouseup",listener:i=>e(this,void 0,void 0,(function*(){if(!this.sliding||!this.rect)return;setTimeout((()=>{l.setState({isProgressSliding:!1})}));const e=(this.mousedownX-this.rect.x)/this.rect.width;try{yield t.seekHandler(e*this.duration)}catch(e){console.log(e)}}))}]),l.subscribe((e=>e.duration),this.setDuration.bind(this)),l.subscribe((e=>e.progress),this.updateProgress.bind(this)),l.subscribe((e=>e.isProgressSliding),(e=>{this.sliding=e}))}setDuration(e){this.duration=e}updateProgress(e){if(this.sliding)return;this.progress=e;const t=0===this.duration?0:this.progress/this.duration;this.track.update(t)}dispose(){this.removeEventListeners(),this.track.dispose()}}class ie extends I{constructor(){super("video-player-container"),this.playerConnectTask=null,this.playerStatus=l.getState().status,this.playerEventPayloads=[],this.embedPlayerOnClose=null,this.embedPlayerElReplacement=null,this.backBlobUrlMap=new Map,this.aheadBlobUrlMap=new Map,this.oldBlobUrl="",this.progressSlider=this.createProgressSlider(),l.subscribe((e=>e.status),(e=>{this.playerStatus=e}))}createProgressSlider(){return new te({seekHandler:this.seekAutoPlay.bind(this)})}getMuted(){return e(this,void 0,void 0,(function*(){return this.playerInstance?this.playerInstance.getMuted():Promise.reject(new Error("No player instance"))}))}setMuted(t,i=!0){return e(this,void 0,void 0,(function*(){return this.playerInstance?this.playerInstance.setMuted(t,i):Promise.reject(new Error("No player instance"))}))}getVolume(){return e(this,void 0,void 0,(function*(){return this.playerInstance?this.playerInstance.getVolume():Promise.reject(new Error("No player instance"))}))}setVolume(t){return e(this,void 0,void 0,(function*(){return this.playerInstance?this.playerInstance.setVolume(t):Promise.reject(new Error("No player instance"))}))}isDmVisible(){return e(this,void 0,void 0,(function*(){return this.playerInstance?this.playerInstance.danmaku.isOpen():Promise.reject(new Error("No player instance"))}))}setDmVisible(t){return e(this,void 0,void 0,(function*(){return this.playerInstance?(t?this.playerInstance.danmaku.open():this.playerInstance.danmaku.close(),!0):Promise.reject(new Error("No player instance"))}))}prepare(){return e(this,void 0,void 0,(function*(){try{return M()}catch(e){return Promise.reject(e)}}))}embed(e){const{instance:t,onClose:i}=e;this.embedPlayerOnClose=i||null,this.embedPlayerElReplacement=document.createElement("div");const n=t.getElements().container.parentElement;this.playerInstance=t,this.addPlayerEventListeners(),l.setState({status:"playing"}),n.parentElement.replaceChild(this.embedPlayerElReplacement,n),this.el.appendChild(n)}eject(){var e;(null===(e=this.embedPlayerElReplacement)||void 0===e?void 0:e.parentElement)&&(this.embedPlayerElReplacement.parentElement.replaceChild(this.el.children[0],this.embedPlayerElReplacement),this.embedPlayerElReplacement=null)}addPlayerEventListeners(){if(!this.playerInstance)return;const e=window.nano,t=[{type:e.EventType.Player_ProgressBar_Change,callback:e=>{var t;l.setState({progress:null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.progressTime})}},{type:e.EventType.Player_Ended,callback:()=>{l.setState({status:"ended"})}}];for(let e=0;e<t.length;e++){const{type:i,callback:n}=t[e];try{this.playerInstance.on(i,n),this.playerEventPayloads.push(t[e])}catch(e){console.warn(e)}}}removePlayerEventListeners(){for(;this.playerEventPayloads.length;){const{type:e,callback:t}=this.playerEventPayloads.pop();this.playerInstance.off(e,t)}}load(t){return e(this,void 0,void 0,(function*(){try{if(this.playerConnectTask)return yield this.playerConnectTask.promise;yield this.prepare(),this.playerInstance=yield P({aid:t.aid,bvid:t.bvid,cid:t.cid,seasonId:t.seasonId,episodeId:t.episodeId,element:this.el,channelKind:"Homepage",stats:{spmId:H("0.0"),spmIdFrom:t.spmIdFrom},controlsList:new Set(["noPlaybackClue"]),featureList:new Set(["noBufferView","noPip"])}),this.addPlayerEventListeners(),this.playerConnectTask=a();return(yield this.playerInstance.connect())?(this.playerConnectTask.resolve(),l.setState({status:"paused",duration:this.playerInstance.getDuration()})):(l.setState({status:"failed"}),this.playerConnectTask.reject("Permission denied")),yield this.playerConnectTask.promise}catch(e){return Promise.reject(e)}}))}start(){return e(this,void 0,void 0,(function*(){try{if(this.playerConnectTask&&(yield this.playerConnectTask.promise),!this.playerInstance)return;return"playing"===this.playerStatus?yield this.pause():yield this.play()}catch(e){return Promise.reject(e)}}))}requestAutoplay(t){var i,n;return e(this,void 0,void 0,(function*(){try{if(this.playerConnectTask&&(yield this.playerConnectTask.promise),!this.playerInstance)return;const s=a(),o=()=>e(this,void 0,void 0,(function*(){var e;clearTimeout(l);const t=yield this.getMuted(),i=this.playerInstance.isPaused();this.playerInstance.off(r.EventType.Player_Play,p),this.playerInstance.off(r.EventType.Media_Autoplay_Not_Allowed,c),null===(e=s.resolve)||void 0===e||e.call(s,{isMuted:t,isPaused:i})})),r=window.nano;let l=null;const d=()=>{l=setTimeout((()=>{var e;this.playerInstance.off(r.EventType.Player_Play,p),this.playerInstance.off(r.EventType.Media_Autoplay_Not_Allowed,c),null===(e=s.resolve)||void 0===e||e.call(s)}),5e3)},p=()=>e(this,void 0,void 0,(function*(){yield o()})),c=()=>e(this,void 0,void 0,(function*(){yield o()}));return this.playerInstance.on(r.EventType.Player_Play,p),this.playerInstance.on(r.EventType.Media_Autoplay_Not_Allowed,c),d(),null===(n=(i=this.playerInstance).requestAutoplay)||void 0===n||n.call(i,t),s.promise}catch(e){return Promise.reject(e)}}))}play(){return e(this,void 0,void 0,(function*(){try{if(this.playerConnectTask&&(yield this.playerConnectTask.promise),!this.playerInstance)return;yield this.playerInstance.play(),l.setState({status:"playing"})}catch(e){return Promise.reject(e)}}))}replay(){return e(this,void 0,void 0,(function*(){try{return yield this.seek(0),yield this.play()}catch(e){return Promise.reject(e)}}))}seek(t){return e(this,void 0,void 0,(function*(){try{if(this.playerConnectTask&&(yield this.playerConnectTask.promise),!this.playerInstance)return;yield this.playerInstance.seek(t)}catch(e){return Promise.reject(e)}}))}seekAutoPlay(t){return e(this,void 0,void 0,(function*(){try{if(this.playerConnectTask&&(yield this.playerConnectTask.promise),!this.playerInstance)return;yield this.seek(t),yield this.play()}catch(e){return Promise.reject(e)}}))}pause(){return e(this,void 0,void 0,(function*(){try{this.playerConnectTask&&(yield this.playerConnectTask.promise),yield this.playerInstance.pause(),l.setState({status:"paused"})}catch(e){return Promise.reject(e)}}))}reset(){this.playerInstance=null,this.playerConnectTask=null,l.setState({status:"unload",duration:0,progress:0})}close(){return e(this,void 0,void 0,(function*(){if(this.playerInstance)try{this.embedPlayerElReplacement?(this.embedPlayerOnClose?this.embedPlayerOnClose():(yield this.pause(),yield this.seek(0)),this.removePlayerEventListeners(),this.setMuted(!0,!1),this.setDmVisible(!0),this.eject()):(this.removePlayerEventListeners(),this.setMuted(!0,!1),this.setDmVisible(!0),yield this.playerInstance.disconnect()),this.reset()}catch(e){return Promise.reject(e)}}))}getBackDropBlobUrl(t){return e(this,void 0,void 0,(function*(){if(!this.backBlobUrlMap.get(t)){const e=this.playerInstance.readFrameAsBlob({width:480}),i=yield e,n=i?URL.createObjectURL(i):null;this.revokeOldBlobURL(),n&&(this.oldBlobUrl=n,this.backBlobUrlMap.set(t,n))}return this.backBlobUrlMap.get(t)}))}getAheadDropBlobUrl(t){return e(this,void 0,void 0,(function*(){if(!this.aheadBlobUrlMap.get(t)){const e=this.playerInstance.readFrameAsBlob({width:480}),i=yield e,n=i?URL.createObjectURL(i):null;this.revokeOldBlobURL(),n&&(this.oldBlobUrl=n,this.aheadBlobUrlMap.set(t,n))}return this.aheadBlobUrlMap.get(t)}))}revokeOldBlobURL(){this.oldBlobUrl&&(URL.revokeObjectURL(this.oldBlobUrl),this.oldBlobUrl="")}dispose(){return e(this,void 0,void 0,(function*(){this.progressSlider.dispose(),this.reset(),this.unmount(),this.revokeOldBlobURL()}))}}class ne extends T{constructor(e){super({className:"bmp-inline-container"}),this.mediaContainer=new Y(e),this.mediaDetails=new X(e),this.el.appendChild(this.mediaContainer.getElement()),this.el.appendChild(this.mediaDetails.getElement()),this.el.style.setProperty("display","none"),this.removeEventListeners=C([{target:this.el,name:"transitionend",listener:e=>{if(e.target!==this.el)return;if("transform"!==e.propertyName)return;null!==this.el.getAttribute("active")?this.el.removeAttribute("enter"):(this.el.removeAttribute("leave"),this.el.style.setProperty("display","none"))}}])}display(e,t={}){this.el.style.setProperty("display",""),this.el.setAttribute("enter","");const i=o.getState();i.displayZIndex&&this.el.style.setProperty("z-index",String(i.displayZIndex+1));const n=e.getBoundingClientRect(),s=10,r=window.innerWidth-10,l=10,a=window.innerHeight-10,d=n.width/.8,p=(d-32)/16*9+91.5+32;this.el.style.setProperty("--bmp-inline-width",`${d}px`);const c=this.limit(n.left-(d-n.width)/2,[s,r-38-d]);this.el.style.setProperty("--bmp-inline-original-horizontal-position",`${c}px`),this.el.style.setProperty("--bmp-inline-original-top-position",`${n.top}px`),this.el.style.setProperty("--bmp-inline-horizontal-position",`${c}px`),this.el.style.setProperty("--bmp-inline-top-position",`${this.limit(n.top-.3*n.height,[l,a-l-p])}px`),setTimeout((()=>{this.el.setAttribute("active","")}),20)}resize(e={}){}hide(){this.el.setAttribute("leave",""),this.el.removeAttribute("active")}limit(e,t){return isNaN(t[0])||(e=Math.max(t[0],e)),isNaN(t[1])||(e=Math.min(t[1],e)),e}dispose(){this.removeEventListeners(),this.mediaContainer.dispose(),this.mediaDetails.dispose(),this.unmount()}}class se extends V{constructor(e){super(e),this.el.innerHTML='<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1.15064 1.44131C1.35149 1.24046 1.67713 1.24046 1.87797 1.44131L5.99944 5.56277L10.122 1.44019C10.3229 1.23934 10.6485 1.23934 10.8494 1.44019C11.0502 1.64104 11.0502 1.96668 10.8494 2.16753L6.72678 6.29011L10.8485 10.4118C11.0493 10.6127 11.0493 10.9383 10.8485 11.1392C10.6476 11.34 10.322 11.34 10.1211 11.1392L5.99944 7.01745L1.87886 11.138C1.67801 11.3389 1.35237 11.3389 1.15152 11.138C0.950676 10.9372 0.950676 10.6115 1.15152 10.4107L5.2721 6.29011L1.15064 2.16865C0.949788 1.9678 0.949788 1.64216 1.15064 1.44131Z" fill="#18191C"/>\n<path d="M1.87797 1.44131L1.66584 1.65344L1.87797 1.44131ZM5.99944 5.56277L5.78731 5.77491L5.99944 5.98704L6.21157 5.77491L5.99944 5.56277ZM10.122 1.44019L9.90989 1.22806L10.122 1.44019ZM10.8494 2.16753L11.0615 2.37966L10.8494 2.16753ZM6.72678 6.29011L6.51464 6.07798L6.30251 6.29011L6.51464 6.50224L6.72678 6.29011ZM10.8485 10.4118L10.6363 10.6239L10.8485 10.4118ZM10.1211 11.1392L9.90901 11.3513L10.1211 11.1392ZM5.99944 7.01745L6.21157 6.80532L5.99944 6.59319L5.78731 6.80532L5.99944 7.01745ZM1.87886 11.138L1.66673 10.9259L1.87886 11.138ZM1.15152 10.4107L0.939392 10.1986H0.939392L1.15152 10.4107ZM5.2721 6.29011L5.48423 6.50224L5.69636 6.29011L5.48423 6.07798L5.2721 6.29011ZM1.15064 2.16865L1.36277 1.95652L1.15064 2.16865ZM2.09011 1.22918C1.7721 0.911174 1.25651 0.911174 0.938505 1.22918L1.36277 1.65344C1.44646 1.56975 1.58215 1.56975 1.66584 1.65344L2.09011 1.22918ZM6.21157 5.35064L2.09011 1.22918L1.66584 1.65344L5.78731 5.77491L6.21157 5.35064ZM9.90989 1.22806L5.78731 5.35064L6.21157 5.77491L10.3342 1.65232L9.90989 1.22806ZM11.0615 1.22806C10.7435 0.910049 10.2279 0.910049 9.90989 1.22806L10.3342 1.65232C10.4178 1.56863 10.5535 1.56863 10.6372 1.65232L11.0615 1.22806ZM11.0615 2.37966C11.3795 2.06165 11.3795 1.54606 11.0615 1.22806L10.6372 1.65232C10.7209 1.73601 10.7209 1.8717 10.6372 1.95539L11.0615 2.37966ZM6.93891 6.50224L11.0615 2.37966L10.6372 1.95539L6.51464 6.07798L6.93891 6.50224ZM11.0606 10.1997L6.93891 6.07798L6.51464 6.50224L10.6363 10.6239L11.0606 10.1997ZM11.0606 11.3513C11.3786 11.0333 11.3786 10.5177 11.0606 10.1997L10.6363 10.6239C10.72 10.7076 10.72 10.8433 10.6363 10.927L11.0606 11.3513ZM9.90901 11.3513C10.227 11.6693 10.7426 11.6693 11.0606 11.3513L10.6363 10.927C10.5527 11.0107 10.417 11.0107 10.3333 10.927L9.90901 11.3513ZM5.78731 7.22958L9.90901 11.3513L10.3333 10.927L6.21157 6.80532L5.78731 7.22958ZM2.09099 11.3502L6.21157 7.22958L5.78731 6.80532L1.66673 10.9259L2.09099 11.3502ZM0.939392 11.3502C1.2574 11.6682 1.77299 11.6682 2.09099 11.3502L1.66673 10.9259C1.58304 11.0096 1.44735 11.0096 1.36366 10.9259L0.939392 11.3502ZM0.939392 10.1986C0.621386 10.5166 0.621387 11.0322 0.939392 11.3502L1.36366 10.9259C1.27997 10.8422 1.27997 10.7065 1.36366 10.6228L0.939392 10.1986ZM5.05997 6.07798L0.939392 10.1986L1.36366 10.6228L5.48423 6.50224L5.05997 6.07798ZM0.938505 2.38078L5.05997 6.50224L5.48423 6.07798L1.36277 1.95652L0.938505 2.38078ZM0.938505 1.22918C0.620499 1.54719 0.620498 2.06278 0.938505 2.38078L1.36277 1.95652C1.27908 1.87283 1.27908 1.73714 1.36277 1.65344L0.938505 1.22918Z" fill="#18191C"/>\n</svg>\n'}}class oe extends T{constructor(e){var t,i;super({className:"bmp-popup-container"}),this.removeEventListeners=m,this.zoomInHanlder=m;const n=o.getState();this.mediaContainer=new Y(e),this.mediaDetails=new X(e),this.el.appendChild(this.mediaContainer.getElement()),this.el.appendChild(this.mediaDetails.getElement()),(null===(i=null===(t=n.popupOptions)||void 0===t?void 0:t.anime)||void 0===i?void 0:i.zoomOut)?(this.fakeMediaContainer=new K,this.el.appendChild(this.fakeMediaContainer.getElement()),this.mediaContainer.getElement().classList.add("zoom-anime")):this.removeEventListeners=C([{target:this.el,name:"transitionend",listener:e=>{if(e.target!==this.el)return;null===this.el.getAttribute("active")&&this.el.style.setProperty("display","none")}}]),this.el.style.setProperty("display","none")}resize(e={}){const t={left:10,right:window.innerWidth-10,top:10,bottom:window.innerHeight-10};t.left+=62,t.right-=62;const{top:i=0,left:n=0,right:s=0,bottom:o=0}=e;t.left+=n,t.right-=s,t.top+=i,t.bottom-=o;const r=t.right-t.left,l=t.bottom-t.top,a=window.innerWidth<1560?902:1101,d=a/16*9;let p=this.limit(a,[0,r]);const c=this.limit(p/16*9,[0,l]);c<d&&(p=c/9*16),p-=2,this.el.style.setProperty("--bmp-popup-width",`${p}px`),this.el.style.setProperty("--bmp-popup-height",`${c}px`),this.el.style.setProperty("--bmp-popup-horizontal-position",`${(r-p)/2+t.left}px`),this.el.style.setProperty("--bmp-popup-top-position",`${(l-c)/2+t.top}px`)}display(e,t={},i){var n,s,r;this.zoomInHanlder=null!==(n=null==i?void 0:i.zoomInHanlder)&&void 0!==n?n:m,this.el.style.setProperty("display","");const l=o.getState();l.displayZIndex&&this.el.style.setProperty("z-index",String(l.displayZIndex+1)),this.resize(t),(null===(r=null===(s=l.popupOptions)||void 0===s?void 0:s.anime)||void 0===r?void 0:r.zoomOut)?this.setZoomInAnime(e):this.el.setAttribute("active","")}limit(e,t){return e=Math.max(t[0],e),e=Math.min(t[1],e)}hide(){var e,t;(null===(t=null===(e=o.getState().popupOptions)||void 0===e?void 0:e.anime)||void 0===t?void 0:t.zoomOut)?this.setZoomOutAnime():this.el.removeAttribute("active")}setZoomInAnime(t){var i,n,s,o,r,l,a,d;const p=t.getBoundingClientRect(),c=this.el.getBoundingClientRect();this.el.style.setProperty("--bmp-popup-init-width",`${p.width}px`),this.el.style.setProperty("--bmp-popup-init-height",`${p.height}px`),this.el.style.setProperty("--bmp-popup-init-horizontal-position",p.left-c.left+"px"),this.el.style.setProperty("--bmp-popup-init-top-position",p.top-c.top+"px"),this.el.setAttribute("zoom-in-anime",""),this.el.setAttribute("zooming",""),null===(o=null===(s=null===(n=null===(i=this.fakeMediaContainer)||void 0===i?void 0:i.getElement)||void 0===n?void 0:n.call(i))||void 0===s?void 0:s.setAttribute)||void 0===o||o.call(s,"zoom-in-anime",""),null===(d=null===(a=null===(l=null===(r=this.fakeMediaContainer)||void 0===r?void 0:r.getElement)||void 0===l?void 0:l.call(r))||void 0===a?void 0:a.setAttribute)||void 0===d||d.call(a,"active",""),this.el.setAttribute("active",""),setTimeout((()=>e(this,void 0,void 0,(function*(){var e,t,i,n,s;this.el.removeAttribute("zoom-in-anime"),this.el.removeAttribute("zooming"),null===(n=null===(i=null===(t=null===(e=this.fakeMediaContainer)||void 0===e?void 0:e.getElement)||void 0===t?void 0:t.call(e))||void 0===i?void 0:i.removeAttribute)||void 0===n||n.call(i,"zoom-in-anime"),this.mediaContainer.getElement().setAttribute("active",""),yield null===(s=this.zoomInHanlder)||void 0===s?void 0:s.call(this)}))),800)}setZoomOutAnime(){var e,t,i,n,s,o,r,l;this.el.setAttribute("zoom-out-anime",""),this.el.setAttribute("zooming",""),null===(n=null===(i=null===(t=null===(e=this.fakeMediaContainer)||void 0===e?void 0:e.getElement)||void 0===t?void 0:t.call(e))||void 0===i?void 0:i.setAttribute)||void 0===n||n.call(i,"zoom-out-anime",""),null===(l=null===(r=null===(o=null===(s=this.fakeMediaContainer)||void 0===s?void 0:s.getElement)||void 0===o?void 0:o.call(s))||void 0===r?void 0:r.removeAttribute)||void 0===l||l.call(r,"active"),this.mediaContainer.getElement().removeAttribute("active"),setTimeout((()=>{var e,t,i,n;this.el.removeAttribute("active"),this.el.removeAttribute("zoom-out-anime"),this.el.removeAttribute("zooming"),null===(n=null===(i=null===(t=null===(e=this.fakeMediaContainer)||void 0===e?void 0:e.getElement)||void 0===t?void 0:t.call(e))||void 0===i?void 0:i.removeAttribute)||void 0===n||n.call(i,"zoom-out-anime"),this.el.style.setProperty("display","none")}),800)}dispose(){var e,t;this.removeEventListeners(),this.mediaContainer.dispose(),null===(t=null===(e=this.fakeMediaContainer)||void 0===e?void 0:e.dispose)||void 0===t||t.call(e),this.mediaDetails.dispose(),this.unmount()}}class re extends V{constructor(e){super(e),this.el.innerHTML='<svg width="32" height="33" viewBox="0 0 32 33" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M9.21967 9.72131C9.51256 9.42842 9.98744 9.42842 10.2803 9.72131L16.2906 15.7315L22.3024 9.71967C22.5953 9.42678 23.0702 9.42678 23.3631 9.71967C23.656 10.0126 23.656 10.4874 23.3631 10.7803L17.3512 16.7922L23.3618 22.8028C23.6547 23.0957 23.6547 23.5706 23.3618 23.8634C23.0689 24.1563 22.594 24.1563 22.3011 23.8634L16.2906 17.8529L10.2816 23.8618C9.98873 24.1547 9.51386 24.1547 9.22096 23.8618C8.92807 23.5689 8.92807 23.094 9.22096 22.8011L15.2299 16.7922L9.21967 10.782C8.92678 10.4891 8.92678 10.0142 9.21967 9.72131Z" fill="#F6F7F8"/>\n<path d="M10.2803 9.72131L10.0682 9.93344L10.2803 9.72131ZM16.2906 15.7315L16.0784 15.9437L16.2906 16.1558L16.5027 15.9437L16.2906 15.7315ZM22.3024 9.71967L22.0903 9.50754L22.3024 9.71967ZM23.3631 10.7803L23.5752 10.9925L23.3631 10.7803ZM17.3512 16.7922L17.1391 16.5801L16.927 16.7922L17.1391 17.0043L17.3512 16.7922ZM22.3011 23.8634L22.089 24.0756L22.3011 23.8634ZM16.2906 17.8529L16.5027 17.6407L16.2906 17.4286L16.0784 17.6407L16.2906 17.8529ZM10.2816 23.8618L10.0695 23.6497L10.2816 23.8618ZM9.22096 22.8011L9.00883 22.589H9.00883L9.22096 22.8011ZM15.2299 16.7922L15.442 17.0043L15.6542 16.7922L15.442 16.5801L15.2299 16.7922ZM9.21967 10.782L9.4318 10.5698L9.21967 10.782ZM10.4925 9.50918C10.0824 9.09913 9.41759 9.09913 9.00754 9.50918L9.4318 9.93344C9.60754 9.75771 9.89246 9.75771 10.0682 9.93344L10.4925 9.50918ZM16.5027 15.5194L10.4925 9.50918L10.0682 9.93344L16.0784 15.9437L16.5027 15.5194ZM22.0903 9.50754L16.0784 15.5194L16.5027 15.9437L22.5146 9.9318L22.0903 9.50754ZM23.5752 9.50754C23.1652 9.09749 22.5004 9.09749 22.0903 9.50754L22.5146 9.9318C22.6903 9.75607 22.9752 9.75607 23.151 9.9318L23.5752 9.50754ZM23.5752 10.9925C23.9853 10.5824 23.9853 9.91759 23.5752 9.50754L23.151 9.9318C23.3267 10.1075 23.3267 10.3925 23.151 10.5682L23.5752 10.9925ZM17.5634 17.0043L23.5752 10.9925L23.151 10.5682L17.1391 16.5801L17.5634 17.0043ZM23.5739 22.5907L17.5634 16.5801L17.1391 17.0043L23.1497 23.0149L23.5739 22.5907ZM23.5739 24.0756C23.984 23.6655 23.984 23.0007 23.5739 22.5907L23.1497 23.0149C23.3254 23.1907 23.3254 23.4756 23.1497 23.6513L23.5739 24.0756ZM22.089 24.0756C22.4991 24.4856 23.1639 24.4856 23.5739 24.0756L23.1497 23.6513C22.9739 23.827 22.689 23.827 22.5133 23.6513L22.089 24.0756ZM16.0784 18.065L22.089 24.0756L22.5133 23.6513L16.5027 17.6407L16.0784 18.065ZM10.4938 24.0739L16.5027 18.065L16.0784 17.6407L10.0695 23.6497L10.4938 24.0739ZM9.00883 24.0739C9.41888 24.484 10.0837 24.484 10.4938 24.0739L10.0695 23.6497C9.89376 23.8254 9.60883 23.8254 9.4331 23.6497L9.00883 24.0739ZM9.00883 22.589C8.59878 22.9991 8.59878 23.6639 9.00883 24.0739L9.4331 23.6497C9.25736 23.4739 9.25736 23.189 9.4331 23.0133L9.00883 22.589ZM15.0178 16.5801L9.00883 22.589L9.4331 23.0133L15.442 17.0043L15.0178 16.5801ZM9.00754 10.9941L15.0178 17.0043L15.442 16.5801L9.4318 10.5698L9.00754 10.9941ZM9.00754 9.50918C8.59749 9.91923 8.59749 10.5841 9.00754 10.9941L9.4318 10.5698C9.25607 10.3941 9.25607 10.1092 9.4318 9.93344L9.00754 9.50918Z" fill="white"/>\n</svg>\n'}}class le extends A{constructor(e){super({className:"bpm-media-start-button",clickHandler:()=>{e()}}),this.value=!1,this.toggle(!0)}toggle(e){this.value=e,this.el.innerHTML=this.value?'<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g opacity="0.9">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M13 17C13 18.1046 13.8954 19 15 19C16.1046 19 17 18.1046 17 17V5C17 3.89543 16.1046 3 15 3C13.8954 3 13 3.89543 13 5V17ZM5 17C5 18.1046 5.89543 19 7 19C8.10457 19 9 18.1046 9 17V5C9 3.89543 8.10457 3 7 3C5.89543 3 5 3.89543 5 5V17Z" fill="white"/>\n</g>\n</svg>\n':'<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g opacity="0.9">\n<path d="M19.25 8.95898C20.8215 9.86624 20.8215 12.1344 19.25 13.0417L8.64289 19.1657C7.07146 20.073 5.10718 18.9389 5.10718 17.1244L5.10718 4.87628C5.10718 3.06175 7.07146 1.92767 8.64289 2.83494L19.25 8.95898Z" fill="white"/>\n</g>\n</svg>\n'}}class ae extends j{constructor(t){super({className:"like-button",clickHandler:()=>e(this,void 0,void 0,(function*(){try{this.setState(yield t())}catch(e){console.log(e)}}))}),this.state=!1,this.setState(!1)}setState(e){this.state=e,this.el.innerHTML=this.state?'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M20.3186 7.74998H15.776C15.999 7.26616 16.2333 6.6567 16.3213 6.06668C16.3848 5.64061 16.3909 5.11874 16.3397 4.62199C16.2897 4.1373 16.1773 3.59536 15.9528 3.16982C15.4775 2.26864 14.8233 1.63578 14.0361 1.48224C13.1988 1.31893 12.4779 1.74495 12.0464 2.39778C11.6856 2.94375 11.5449 3.39925 11.4167 3.81444L11.4167 3.81444L11.4125 3.82786C11.2892 4.22696 11.1679 4.61901 10.8559 5.17154C10.3427 6.08056 9.92397 6.55203 9.36125 7.0454C9.07096 7.29991 8.77244 7.47251 8.49988 7.58315V21.225C9.28733 21.2418 10.1289 21.2524 11 21.2524C13.3441 21.2524 15.3224 21.1759 16.627 21.1071C17.9072 21.0396 19.1311 20.3943 19.7997 19.2217C20.4316 18.1135 21.2409 16.4358 21.7288 14.4296C22.1856 12.5508 22.3761 11.0232 22.4535 9.98474C22.5487 8.70656 21.5102 7.74998 20.3186 7.74998ZM6.99988 21.1842V7.74998H5.30231C3.75928 7.74998 2.38771 8.85084 2.21213 10.4483C2.10046 11.4642 2 12.7852 2 14.2524C2 15.839 2.11749 17.3111 2.23926 18.4118C2.40726 19.9306 3.65916 21.0399 5.15251 21.1103C5.68495 21.1355 6.30846 21.1615 6.99988 21.1842Z" fill="currentColor"/>\n</svg>\n':'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M13.9252 3.04546C13.6432 3.01258 13.382 3.13521 13.2422 3.29868C12.9774 3.60848 12.8705 3.86276 12.7384 4.23799C12.7234 4.28037 12.7082 4.32422 12.6925 4.36961C12.5611 4.74857 12.3929 5.23391 12.044 5.85187C11.446 6.91117 10.8882 7.55173 10.2013 8.154C9.63865 8.6473 9.06639 8.98294 8.5 9.14275V19.7248C9.28689 19.7417 10.1287 19.7525 11 19.7525C13.2468 19.7525 15.1529 19.6812 16.4372 19.615C17.3477 19.5681 18.1379 19.1176 18.5497 18.3851C19.1274 17.3574 19.8396 15.8503 20.2712 14.0753C20.6734 12.4212 20.8569 11.0615 20.9392 10.1025C20.9774 9.65797 20.6256 9.25003 20.08 9.25003H15.0977C14.8476 9.25003 14.614 9.12542 14.4748 8.91775C14.3355 8.71015 14.3089 8.44684 14.4037 8.21557C14.4037 8.21555 14.4037 8.21553 14.4037 8.21551C14.4037 8.21547 14.4038 8.21543 14.4038 8.21539C14.4038 8.21537 14.4038 8.21536 14.4038 8.21534L14.4046 8.21341L14.4085 8.20377L14.4249 8.16256C14.4395 8.12573 14.4609 8.07081 14.4874 8.00089C14.5404 7.86084 14.6131 7.66185 14.6909 7.42856C14.8489 6.95439 15.0177 6.36917 15.0941 5.85681C15.2109 5.07451 15.1824 4.44592 14.8757 3.86439C14.5461 3.23954 14.1724 3.07429 13.9252 3.04546ZM16.164 7.75003H20.08C21.4037 7.75003 22.5555 8.81291 22.4337 10.2309C22.3455 11.2583 22.1508 12.6941 21.7288 14.4297C21.2555 16.3758 20.4798 18.0127 19.8573 19.1201C19.1594 20.3616 17.8654 21.0435 16.5144 21.113C15.21 21.1802 13.2777 21.2525 11 21.2525C8.7933 21.2525 6.77664 21.1846 5.34776 21.1195C3.73985 21.0461 2.39101 19.8517 2.21798 18.2152C2.1042 17.1391 2 15.7467 2 14.2525C2 12.8835 2.08746 11.6418 2.18985 10.6567C2.36874 8.93544 3.84615 7.75003 5.50754 7.75003H7.75C8.06896 7.75003 8.56382 7.59478 9.21241 7.02612C9.77509 6.53279 10.2246 6.0235 10.7378 5.11442C11.0177 4.61868 11.146 4.24973 11.2753 3.87788C11.2913 3.83198 11.3072 3.78604 11.3235 3.73981C11.4791 3.29802 11.6602 2.84083 12.1021 2.32398C12.5582 1.79047 13.3077 1.4633 14.0989 1.55555C14.9248 1.65186 15.6866 2.18668 16.2024 3.16456C16.7233 4.15199 16.7157 5.15349 16.5777 6.07814C16.4916 6.65522 16.3202 7.26593 16.164 7.75003ZM7 19.6835V9.25003H5.50754C4.54442 9.25003 3.77423 9.92257 3.68182 10.8118C3.58359 11.7569 3.5 12.9457 3.5 14.2525C3.5 15.6802 3.59975 17.0179 3.70967 18.0575C3.80099 18.9212 4.51252 19.5798 5.41611 19.621C5.88508 19.6424 6.41785 19.6641 7 19.6835Z" fill="currentColor"/>\n</svg>\n',this.state?this.el.setAttribute("active",""):this.el.removeAttribute("active")}}class de extends j{constructor(t){super({className:"dm-button",clickHandler:()=>e(this,void 0,void 0,(function*(){try{this.setVisible(yield t.clickHandler())}catch(e){console.log(e)}}))}),this.isVisible=!0,this.setVisible(this.isVisible)}setVisible(e){this.isVisible=e,this.el.innerHTML=this.isVisible?'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M8.28157 5.18599L7.08678 3.3921C6.77807 2.92861 6.90355 2.30262 7.36705 1.99392C7.83054 1.68522 8.45653 1.8107 8.76523 2.27419L10.5321 4.92698C10.5769 4.99431 10.6126 5.06508 10.6394 5.1378C11.1176 5.1315 11.5677 5.12808 11.9897 5.12754L12.0002 5.12746L12.0545 5.12748L12.1089 5.12746L12.1194 5.12754C12.4116 5.12791 12.7173 5.12967 13.0365 5.13281C13.0671 5.05098 13.109 4.97181 13.1624 4.89745L15.0691 2.24466C15.3941 1.79246 16.0241 1.68934 16.4763 2.01436C16.9285 2.33937 17.0317 2.96943 16.7066 3.42163L15.4456 5.17617C16.2899 5.19714 17.2003 5.22488 18.177 5.25939C19.9733 5.32285 21.3761 6.72978 21.6309 8.509C21.7163 9.10521 21.758 10.6457 21.7886 11.778C21.7976 12.1109 21.8056 12.4086 21.8136 12.6366C21.8268 13.016 21.5298 13.3343 21.1504 13.3475C20.7709 13.3607 20.4526 13.0638 20.4394 12.6843C20.4314 12.4549 20.4234 12.148 20.4145 11.804C20.3861 10.7135 20.3481 9.25066 20.2698 8.70396C20.1093 7.58371 19.2595 6.67349 18.1285 6.63353C15.6824 6.54711 13.6574 6.50344 12.0545 6.50248C10.4517 6.50344 8.42667 6.54711 5.98062 6.63353C4.84964 6.67349 3.90973 7.5179 3.74927 8.63815C3.59757 9.69723 3.521 11.0138 3.521 12.5848C3.521 14.4698 3.63122 16.086 3.85013 17.4314C4.0272 18.5196 4.94059 19.3361 6.04177 19.3906C7.9177 19.4834 9.30376 19.5298 11.4726 19.5298C11.8523 19.5298 12.1601 19.8377 12.1601 20.2173C12.1601 20.597 11.8523 20.9048 11.4726 20.9048C9.28184 20.9048 7.87324 20.8579 5.97381 20.7639C4.22488 20.6774 2.77421 19.3805 2.49298 17.6522C2.26114 16.2274 2.146 14.539 2.146 12.5848C2.146 10.9532 2.22623 9.57369 2.38816 8.44319C2.643 6.66397 4.13581 5.32285 5.93207 5.25939C6.7632 5.23002 7.54635 5.20556 8.28157 5.18599ZM12.5107 9.60343H11.1907V14.2344H13.4127V15.0814H10.7947V16.1594H13.4127L13.4153 16.8371C13.7757 16.8633 14.1292 16.9997 14.4252 17.2441H14.5347V16.1594H17.2297V15.0814H14.5347V14.2344H16.8007V9.60343H15.5247C15.7997 9.18543 16.0527 8.71243 16.2727 8.18443L15.1837 7.79943C14.9417 8.43743 14.6777 9.04243 14.3697 9.60343H12.8517L13.5447 9.29543C13.3137 8.78943 13.0387 8.32743 12.7307 7.88743L11.6857 8.23943C11.9827 8.63543 12.2577 9.08643 12.5107 9.60343ZM8.33068 13.1674L8.48468 11.6824H10.4647V8.29443H7.26368V9.27343H9.33168V10.7034H7.47268L7.16468 14.1574H9.44168C9.44168 15.3234 9.39768 16.0824 9.32068 16.4344C9.24368 16.7864 8.93568 16.9624 8.38568 16.9624C8.07768 16.9624 7.76968 16.9404 7.48368 16.9074L7.78068 17.9744L7.84223 17.9788C8.12696 17.9993 8.39382 18.0184 8.66068 18.0184C9.66168 17.9524 10.2227 17.6004 10.3547 16.9624C10.4647 16.3244 10.5307 15.0594 10.5307 13.1674H8.33068ZM15.7887 13.2774V12.4194H14.5347V13.2774H15.7887ZM13.4127 12.4194V13.2774H12.2137V12.4194H13.4127ZM12.2137 11.4734H13.4127V10.5714H12.2137V11.4734ZM14.5347 11.4734V10.5714H15.7887V11.4734H14.5347Z" fill="currentColor"/>\n<path d="M21.6201 14.869C21.8972 14.5611 22.3714 14.536 22.6793 14.813C22.9593 15.0649 23.0054 15.4797 22.8034 15.7844L22.7353 15.8722L16.9309 22.3705C16.665 22.6661 16.2209 22.6991 15.9156 22.4633L15.8361 22.3923L12.8798 19.3579C12.5907 19.0612 12.5969 18.5863 12.8936 18.2973C13.1633 18.0345 13.5803 18.0158 13.871 18.2374L13.9542 18.3111L16.3512 20.7711L21.6201 14.869Z" fill="#00AEEC"/>\n</svg>\n':'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7.08678 3.3921L8.28157 5.18599C7.54635 5.20556 6.7632 5.23002 5.93207 5.25939C4.13581 5.32285 2.643 6.66397 2.38816 8.44319C2.22623 9.57369 2.146 10.9532 2.146 12.5848C2.146 14.539 2.26114 16.2274 2.49298 17.6522C2.77421 19.3805 4.22488 20.6774 5.97381 20.7639C7.87324 20.8579 10.3379 20.9048 12.5286 20.9048C12.9083 20.9048 13.2161 20.597 13.2161 20.2173C13.2161 19.8377 12.9083 19.5298 12.5286 19.5298C10.3598 19.5298 7.9177 19.4834 6.04177 19.3906C4.94059 19.3361 4.0272 18.5196 3.85013 17.4314C3.63122 16.086 3.521 14.4698 3.521 12.5848C3.521 11.0138 3.59757 9.69723 3.74927 8.63815C3.90973 7.5179 4.84964 6.67349 5.98062 6.63353C8.40342 6.54793 10.4131 6.50428 12.0087 6.50251C13.6043 6.50428 15.614 6.54793 18.0368 6.63353C19.1678 6.67349 20.1077 7.5179 20.2682 8.63815C20.4199 9.69723 20.4735 11.0895 20.4735 12.6605C20.4735 13.0402 20.7813 13.348 21.161 13.348C21.5407 13.348 21.8485 13.0402 21.8485 12.6605C21.8485 11.0289 21.7912 9.57369 21.6293 8.44319C21.3744 6.66397 19.8816 5.32285 18.0854 5.25939C17.1433 5.2261 16.2629 5.19911 15.444 5.17842L16.7066 3.42163C17.0317 2.96943 16.9285 2.33937 16.4763 2.01436C16.0241 1.68934 15.3941 1.79246 15.0691 2.24466L13.1624 4.89745C13.1088 4.97209 13.0668 5.05158 13.0361 5.13374C12.7205 5.1304 12.4178 5.1284 12.128 5.12772L12.1089 5.12746L12.0087 5.12751L11.9085 5.12746L11.8894 5.12772C11.4966 5.12864 11.0799 5.132 10.6394 5.1378C10.6126 5.06508 10.5769 4.99431 10.5321 4.92698L8.76523 2.27419C8.45653 1.8107 7.83054 1.68522 7.36705 1.99392C6.90355 2.30262 6.77807 2.92861 7.08678 3.3921ZM11.2016 9.59769H12.5216C12.2686 9.08069 11.9936 8.62969 11.6966 8.23369L12.7416 7.88169C13.0496 8.32169 13.3246 8.78369 13.5556 9.28969L12.8626 9.59769H14.3806C14.6886 9.03669 14.9526 8.43169 15.1946 7.79369L16.2836 8.17869C16.0636 8.70669 15.8106 9.17969 15.5356 9.59769H16.8116V13.039C15.1629 13.4111 13.8228 14.5976 13.2364 16.1537H10.8056V15.0757H13.4236V14.2287H11.2016V9.59769ZM8.49559 11.6767L8.34159 13.1617H10.5416C10.5416 15.0537 10.4756 16.3187 10.3656 16.9567C10.2336 17.5947 9.67259 17.9467 8.67159 18.0127C8.40474 18.0127 8.13788 17.9935 7.85315 17.9731L7.79159 17.9687L7.49459 16.9017C7.78059 16.9347 8.08859 16.9567 8.39659 16.9567C8.94659 16.9567 9.25459 16.7807 9.33159 16.4287C9.40859 16.0767 9.45259 15.3177 9.45259 14.1517H7.17559L7.48359 10.6977H9.34259V9.26769H7.27459V8.28869H10.4756V11.6767H8.49559ZM15.7996 12.4137V13.2717H14.5456V12.4137H15.7996ZM13.4236 13.2717V12.4137H12.2246V13.2717H13.4236ZM13.4236 11.4677H12.2246V10.5657H13.4236V11.4677ZM14.5456 10.5657V11.4677H15.7996V10.5657H14.5456ZM22.0627 18.0623C22.0627 20.2715 20.2718 22.0623 18.0627 22.0623C15.8535 22.0623 14.0627 20.2715 14.0627 18.0623C14.0627 15.8532 15.8535 14.0623 18.0627 14.0623C20.2718 14.0623 22.0627 15.8532 22.0627 18.0623ZM15.3258 18.0623C15.3258 19.5738 16.5511 20.7992 18.0627 20.7992C18.5792 20.7992 19.0624 20.656 19.4746 20.4073L15.7174 16.6508C15.4688 17.063 15.3258 17.5459 15.3258 18.0623ZM20.4076 19.4743C20.6564 19.0621 20.7995 18.5789 20.7995 18.0623C20.7995 16.5508 19.5742 15.3255 18.0627 15.3255C17.5459 15.3255 17.0625 15.4687 16.6502 15.7177L20.4076 19.4743Z" fill="currentColor"/>\n</svg>\n'}}class pe extends j{constructor(t){super({className:"volume-button",clickHandler:()=>e(this,void 0,void 0,(function*(){try{this.setMuted(yield t())}catch(e){console.log(e)}}))}),this.isMuted=!0,this.setMuted(!0)}setMuted(e){this.isMuted=e,this.el.innerHTML=this.isMuted?'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7815 4.28523C13.2722 3.89261 14 4.24201 14 4.87129V19.1286C14 19.7579 13.2722 20.1073 12.7815 19.7147L8.54026 16.3217C7.87534 15.7897 7.04918 15.4999 6.19766 15.4999H4.38145C4.03827 15.4999 3.79833 15.281 3.7531 15.0177C3.62929 14.2971 3.49999 13.2456 3.5 11.9999C3.50001 10.7543 3.6293 9.70279 3.7531 8.98216C3.79833 8.71888 4.03828 8.49994 4.38146 8.49994H6.19766C7.04917 8.49994 7.87534 8.21014 8.54026 7.6782L12.7815 4.28523ZM15.5 4.87129C15.5 2.98504 13.318 1.9351 11.8444 3.11392L7.60322 6.50689C7.20427 6.82606 6.70857 6.99994 6.19766 6.99994H4.38146C3.38521 6.99994 2.45632 7.67137 2.27476 8.72819C2.13963 9.51477 2.00001 10.6527 2 11.9999C1.99999 13.3472 2.13962 14.4851 2.27475 15.2717C2.45632 16.3285 3.3852 16.9999 4.38145 16.9999H6.19766C6.70857 16.9999 7.20427 17.1738 7.60322 17.493L11.8444 20.886C13.318 22.0648 15.5 21.0148 15.5 19.1286V4.87129ZM23.2803 10.0301C23.5732 9.73719 23.5732 9.26231 23.2803 8.96942C22.9874 8.67653 22.5125 8.67653 22.2196 8.96943L20.2499 10.9391L18.2803 8.96951C17.9874 8.67662 17.5125 8.67662 17.2196 8.96952C16.9267 9.26241 16.9267 9.73729 17.2196 10.0302L19.1893 11.9998L17.2196 13.9693C16.9267 14.2622 16.9267 14.7371 17.2196 15.03C17.5125 15.3229 17.9874 15.3229 18.2803 15.03L20.2499 13.0604L22.2196 15.0301C22.5125 15.323 22.9874 15.323 23.2803 15.0301C23.5732 14.7372 23.5732 14.2623 23.2803 13.9694L21.3106 11.9998L23.2803 10.0301Z" fill="currentColor"/>\n</svg>\n':'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7815 4.28523C13.2722 3.89261 14 4.24201 14 4.87129V19.1286C14 19.7579 13.2722 20.1073 12.7815 19.7147L8.54026 16.3217C7.87534 15.7897 7.04918 15.4999 6.19766 15.4999H4.38145C4.03827 15.4999 3.79833 15.281 3.7531 15.0177C3.62929 14.2971 3.49999 13.2456 3.5 11.9999C3.50001 10.7543 3.6293 9.70279 3.7531 8.98216C3.79833 8.71888 4.03828 8.49994 4.38146 8.49994H6.19766C7.04917 8.49994 7.87534 8.21014 8.54026 7.6782L12.7815 4.28523ZM15.5 4.87129C15.5 2.98504 13.318 1.9351 11.8444 3.11392L7.60322 6.50689C7.20427 6.82606 6.70857 6.99994 6.19766 6.99994H4.38146C3.38521 6.99994 2.45632 7.67137 2.27476 8.72819C2.13963 9.51477 2.00001 10.6527 2 11.9999C1.99999 13.3472 2.13962 14.4851 2.27475 15.2717C2.45632 16.3285 3.3852 16.9999 4.38145 16.9999H6.19766C6.70857 16.9999 7.20427 17.1738 7.60322 17.493L11.8444 20.886C13.318 22.0648 15.5 21.0148 15.5 19.1286V4.87129ZM20.0601 5.43596C20.3753 5.16727 20.8487 5.20501 21.1174 5.52025C24.294 9.24718 24.294 14.7521 21.1174 18.479C20.8487 18.7943 20.3753 18.832 20.0601 18.5633C19.7448 18.2946 19.7071 17.8213 19.9758 17.506C22.6745 14.3398 22.6745 9.65954 19.9758 6.49327C19.7071 6.17803 19.7448 5.70466 20.0601 5.43596ZM17.2445 8.24397C17.5752 7.99456 18.0455 8.06047 18.2949 8.39118C19.9017 10.5217 19.9017 13.4763 18.2949 15.6069C18.0455 15.9376 17.5752 16.0035 17.2445 15.7541C16.9138 15.5047 16.8479 15.0344 17.0973 14.7037C18.3009 13.1078 18.3009 10.8903 17.0973 9.29437C16.8479 8.96366 16.9138 8.49338 17.2445 8.24397Z" fill="currentColor"/>\n</svg>\n'}}class ce extends T{constructor(){super({className:"bmp-tooltip"}),this.text=new U({tag:"span",className:"bmp-tooltip-text"}),this.el.appendChild(this.text.getElement())}setTextContent(e){this.text.setContent(e)}show(){this.el.setAttribute("visible","")}hide(){this.el.removeAttribute("visible")}dispose(){this.text.unmount(),this.unmount()}}const he=(e,t)=>{let i="";const n=t||document.cookie;if(!n)return i;const s=n.split(";"),o=new RegExp(`^${e}=`);for(let e=0;e<s.length;e++){const t=s[e].trim();if(o.test(t)){i=t.split("=")[1];break}}return i},ue=t=>e(void 0,void 0,void 0,(function*(){try{if(!(w(t)||t.aid&&t.bvid&&t.cid&&t.ugcInfo)){const n=yield(i={aid:t.aid,bvid:t.bvid},e(void 0,void 0,void 0,(function*(){try{if(!i.aid&&!i.bvid)return Promise.reject(new Error("Get video view query is empty"));const e=yield window.fetch(k({url:"//api.bilibili.com/x/web-interface/view",query:{aid:i.aid,bvid:i.aid?void 0:i.bvid}})),t=yield e.json();return 0!==t.code?Promise.reject(t):t.data}catch(e){return Promise.reject(e)}})));t.aid=n.aid,t.bvid=n.bvid,t.cid=n.cid,t.ugcInfo=n}}catch(e){return Promise.reject(e)}var i})),me=()=>e(void 0,void 0,void 0,(function*(){try{let e;if(void 0===window.__BiliUser__){const t=yield window.fetch("//api.bilibili.com/x/web-interface/nav",{credentials:"include"});e=yield t.json()}else e=yield window.__BiliUser__.get();return e.data}catch(e){return Promise.reject(e)}})),ve=e=>{void 0!==window.__BiliUser__?window.__BiliUser__.quickLogin(e):window.location.href=`https://passport.bilibili.com/login?gourl=${encodeURIComponent(location.href)}`};class be extends A{constructor(e){super({className:"watch-later-button",clickHandler:e}),this.isAdded=!0,this.toggle(!1)}toggle(e){e!==this.isAdded&&(void 0===e&&(e=!this.isAdded),this.isAdded=e,this.el.innerHTML=this.isAdded?'<svg viewBox="0 0 200 200">\n<g>\n    <path\n            d="M176.725 56.608c1.507 1.508 2.44 3.591 2.44 5.892s-0.932 4.384-2.44 5.892l-92.883 92.892c-2.262 2.264-5.388 3.664-8.842 3.664s-6.579-1.4-8.842-3.664l-51.217-51.225c-1.57-1.517-2.544-3.642-2.544-5.994 0-4.602 3.731-8.333 8.333-8.333 2.352 0 4.477 0.974 5.992 2.542l48.277 48.277 89.942-89.942c1.508-1.507 3.591-2.44 5.892-2.44s4.384 0.932 5.892 2.44v0z"\n            fill="#ffffff"\n    ></path>\n</g>\n</svg>\n':'<svg viewBox="0 0 200 200">\n<path\nd="M17.5 100c0-45.563 36.937-82.5 82.501-82.5 44.504 0 80.778 35.238 82.442 79.334l-7.138-7.137c-2.929-2.929-7.678-2.929-10.607 0s-2.93 7.678 0 10.606l20.001 20c2.929 2.929 7.678 2.929 10.607 0l20.002-20c2.929-2.929 2.929-7.677 0-10.606s-7.678-2.929-10.607 0l-7.245 7.245c-1.616-52.432-44.63-94.441-97.455-94.441-53.848 0-97.501 43.652-97.501 97.5s43.653 97.5 97.501 97.5c32.719 0 61.673-16.123 79.346-40.825 2.41-3.369 1.633-8.054-1.736-10.464s-8.053-1.633-10.463 1.736c-14.978 20.934-39.472 34.553-67.147 34.553-45.564 0-82.501-36.937-82.501-82.5zM127.388 87.078c9.215 5.743 9.215 20.101 0 25.843l-29.62 18.46c-9.215 5.742-20.734-1.436-20.734-12.922v-36.918c0-11.486 11.519-18.664 20.734-12.921l29.62 18.459z"\nfill="#ffffff"\n></path>\n</svg>\n')}}class ge extends T{constructor(){super({className:"bmp-watch-later"}),this.aid=0,this.pending=!1,this.tooltip=new ce,this.button=new be((()=>e(this,void 0,void 0,(function*(){if(this.pending)return;this.pending=!0;const t=!this.button.isAdded;try{if(!(yield me()).isLogin)return ve(),void(this.pending=!1);yield(i=this.aid,n=t,e(void 0,void 0,void 0,(function*(){try{const e=new FormData;return e.append("aid",String(i)),e.append("csrf",he("bili_jct")),yield window.fetch("//api.bilibili.com/x/v2/history/toview/"+(n?"add":"del"),{method:"POST",credentials:"include",body:e}),n}catch(e){return Promise.reject(e)}}))),this.pending=!1,this.button.toggle(),this.tooltip.setTextContent(t?this.tips[1]:this.tips[3]),d.emit("watch-later",{aid:this.aid,state:t})}catch(e){return this.pending=!1,this.tooltip.setTextContent(t?this.tips[4]:this.tips[5]),Promise.reject(e)}var i,n})))),this.tips=["稍后再看","已加稍后再看","移除","已从稍后再看列表中移除","添加失败，请重试","移除失败，请重试"],this.tooltip.setTextContent(this.tips[0]),this.el.appendChild(this.button.getElement()),this.el.appendChild(this.tooltip.getElement()),this.button.getElement().addEventListener("mouseenter",(()=>{this.tooltip.show()})),this.button.getElement().addEventListener("mouseleave",(()=>{this.tooltip.hide(),setTimeout((()=>{this.tooltip.setTextContent(this.button.isAdded?this.tips[2]:this.tips[0])}),300)}))}refresh(e){this.aid=e,this.button.toggle(!1),this.tooltip.setTextContent(this.button.isAdded?this.tips[2]:this.tips[0])}dispose(){this.tooltip.dispose(),this.button.dispose()}}const ye="media-preview_guide-tip";class fe extends A{constructor(e){super({className:e.className,clickHandler:e.clickHandler}),this.el.innerHTML=e.text}}class Ce extends U{constructor(e){super({className:e.className}),this.setContent(e.text)}}class we extends T{}class xe extends T{constructor(e){var t;super(),this.tipText=null!==(t=null==e?void 0:e.tipText)&&void 0!==t?t:"",this.alwaysShowTip="always"===(null==e?void 0:e.visibleType),this.neverShowTip="never"===(null==e?void 0:e.visibleType),this.neverShowTip||!this.alwaysShowTip&&"1"===localStorage.getItem(ye)?this.hide():this.init()}init(){this.el.classList.add("bmp-guide-tip");const e=new we({className:"bmp-guide-tip-wrap"}),t=new Ce({className:"bmp-guide-tip-header",text:"你解锁了新模式"}),i=new Ce({className:"bmp-guide-tip-info",text:this.tipText||"全屏预览模式，鼠标悬停视频卡即自动开启"}),n=new fe({className:"bmp-guide-tip-btn",text:"知道了",clickHandler:this.confirm.bind(this)});e.getElement().appendChild(t.getElement()),e.getElement().appendChild(i.getElement()),this.el.innerHTML='<svg width="35" height="63" viewBox="0 0 35 63" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M3.96752 42.0355L2.35302 55.0116C2.07678 56.7411 3.10451 61.8762 7.59114 61.8762C11.5305 61.8762 13.4178 55.4011 12.4844 48.6994C9.72551 47.1347 6.8122 44.6194 3.96752 42.0355Z" fill="#414653" stroke="black" stroke-width="0.686293" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M5.9938 43.5436H10.7481L10.3294 46.3351L9.60713 48.9824L7.3252 50.2298L4.70013 46.3351L5.9938 43.5436Z" fill="white" stroke="black" stroke-width="0.686293" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M7.32523 48.0321C7.32523 48.0321 9.15077 47.6838 10.3295 46.3369L11.2045 46.8911C11.2045 46.8911 10.7172 49.0289 10.1768 50.4667L7.32352 50.2316V48.0338L7.32523 48.0321Z" fill="#53596B" stroke="black" stroke-width="0.686293" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M8.12135 52.1857L2.35306 55.0115C2.07683 56.741 3.10284 61.8762 7.59119 61.8762" fill="#414653"/>\n<path d="M8.12135 52.1857L2.35306 55.0115C2.07683 56.741 3.10284 61.8762 7.59119 61.8762" stroke="black" stroke-width="0.686293" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M8.8093 52.7485C8.8093 52.7485 9.83702 54.2326 10.4066 56.4785" stroke="black" stroke-width="0.686293" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M8.80935 52.7484L6.61836 50.9555L2.35477 55.0132C2.27585 55.5056 2.3033 56.276 2.48688 57.1253C4.82371 58.0243 8.19169 57.5988 9.35152 53.687C9.04441 53.0899 8.81107 52.7484 8.81107 52.7484H8.80935Z" fill="white" stroke="black" stroke-width="0.686293" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M2.03735 51.321C1.65646 53.1465 1.60499 54.6443 3.0462 55.6944C4.33986 56.6363 8.20026 56.2468 8.80763 52.7467C9.41671 49.2467 8.35124 47.4211 7.21028 46.3574C5.86343 45.1015 3.2538 44.3791 2.41824 46.3574" fill="white"/>\n<path d="M2.03735 51.321C1.65646 53.1465 1.60499 54.6443 3.0462 55.6944C4.33986 56.6363 8.20026 56.2468 8.80763 52.7467C9.41671 49.2467 8.35124 47.4211 7.21028 46.3574C5.86343 45.1015 3.2538 44.3791 2.41824 46.3574" stroke="black" stroke-width="0.686293" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M1.16747 48.5794C0.479457 48.0681 0.604706 46.56 2.41995 46.3575C4.36902 46.1396 5.71072 47.6512 5.71072 47.6512" fill="white"/>\n<path d="M1.16747 48.5794C0.479457 48.0681 0.604706 46.56 2.41995 46.3575C4.36902 46.1396 5.71072 47.6512 5.71072 47.6512" stroke="black" stroke-width="0.686293" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M4.0928 49.5521C2.45771 47.9547 0.36452 48.3923 0.0608359 49.5332C-0.242849 50.6742 0.623596 51.4548 1.92069 51.949" fill="white"/>\n<path d="M4.09281 49.5521C2.45771 47.9547 0.36452 48.3923 0.0608359 49.5332C-0.242849 50.6742 0.623596 51.4548 1.92069 51.949" stroke="black" stroke-width="0.686293" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M2.03735 51.3212C1.65646 53.1467 1.60499 54.6445 3.0462 55.6946L2.03735 51.3212Z" fill="white"/>\n<path d="M2.03735 51.3212C1.65646 53.1467 1.60499 54.6445 3.0462 55.6946" stroke="black" stroke-width="0.686293" stroke-linecap="round" stroke-linejoin="round"/>\n<mask id="mask0_6347_310217" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="3" y="0" width="32" height="49">\n<rect x="3.25894" width="31.741" height="48.5552" fill="#D9D9D9"/>\n</mask>\n<g mask="url(#mask0_6347_310217)">\n<path d="M18.4747 5.931L17.0507 12.2312" stroke="black" stroke-width="4.4609" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M31.6739 18.0148L25.523 19.9879" stroke="black" stroke-width="4.4609" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M32.6398 28.0398C32.0067 24.1314 26.2109 18.8916 22.1464 15.1701C18.0818 11.4487 12.3512 6.13681 8.40163 5.85028C4.45373 5.56376 1.14065 8.96605 -2.9651 13.451C-7.07084 17.9359 -10.5589 22.3693 -9.37507 26.3069C-8.19121 30.2428 -3.67198 34.5064 0.744316 38.5487C5.15889 42.591 9.80338 46.7173 13.8285 47.5494C17.8536 48.3815 21.9628 44.5177 26.0702 40.0328C30.176 35.5479 33.2729 31.9483 32.6398 28.0416V28.0398Z" fill="white" stroke="black" stroke-width="0.686293" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M4.68372 18.2962L10.79 20.8972" stroke="black" stroke-width="2.74517" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M20.5713 32.8404L17.4418 26.9864" stroke="black" stroke-width="2.74517" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M13.9384 31.183C13.9384 31.183 12.1231 32.6466 10.7934 31.4284C9.46372 30.2102 10.3061 28.1016 10.3061 28.1016C10.3061 28.1016 8.27987 29.1276 6.95018 27.9094C5.62049 26.6913 6.91758 24.7559 6.91758 24.7559" stroke="black" stroke-width="1.37259" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M28.7382 28.7056C28.5014 26.9607 22.1137 21.0088 19.2244 18.3632C16.3351 15.7175 9.84282 9.87888 8.08419 9.79652C6.32557 9.71417 1.96246 14.4805 -0.168477 16.8087C-2.29942 19.137 -5.46494 22.5942 -5.44607 24.243C-5.42719 25.8901 -0.283431 31.2312 3.92011 35.0813C8.12365 38.9296 13.8971 43.5827 15.5408 43.4557C17.1844 43.3305 20.35 39.8716 22.4809 37.545C24.6118 35.2168 28.9749 30.4522 28.7382 28.7073V28.7056Z" stroke="black" stroke-width="1.37259" stroke-linecap="round" stroke-linejoin="round"/>\n</g>\n</svg>\n',this.el.appendChild(e.getElement()),this.el.appendChild(n.getElement())}confirm(){this.hide(),localStorage.setItem(ye,"1")}show(){this.neverShowTip||!this.alwaysShowTip&&"1"===localStorage.getItem(ye)||(this.el.style.display="")}dispose(){this.unmount()}}class ke extends A{constructor(e){super({className:"bpm-jump-button",clickHandler:()=>{e()}}),this.el.innerHTML=`<span class="${this.el.className}-text">进入详情页</span><span class="${this.el.className}-icon">\n<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M5.76767 2.10083C5.45525 2.41325 5.45525 2.91978 5.76767 3.2322L10.5353 7.99985L5.76767 12.7675C5.45525 13.0799 5.45525 13.5864 5.76767 13.8989C6.08009 14.2113 6.58662 14.2113 6.89904 13.8989L11.9967 8.80124C12.4393 8.35864 12.4393 7.64106 11.9967 7.19846L6.89904 2.10083C6.58662 1.78841 6.08009 1.78841 5.76767 2.10083Z"/>\n</svg>\n</span>`}}class Le extends A{constructor(e){super({className:"bmp-replay-button",clickHandler:()=>{e()}}),this.el.innerHTML=`<span class="${this.el.className}-icon">\n<svg width="22" height="22" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">\n<path d="M11.1469 3.76866C7.05723 3.76866 3.66226 7.16362 3.66226 11.2533C3.66226 15.3431 7.05723 18.738 11.1469 18.738C13.7523 18.738 16.0852 17.4246 17.5156 15.2866C17.6963 14.9225 18.1728 14.6047 18.5669 14.6047C19.2775 14.6047 19.8794 15.1562 19.8794 15.9172C19.8794 16.0759 19.8489 16.2027 19.7927 16.3424C19.7796 16.3749 19.773 16.4772 19.773 16.4772L19.6998 16.5916C17.8602 19.4663 14.7021 21.2581 11.2533 21.2581C5.69641 21.2581 1.25 16.8108 1.25 11.2533C1.25 5.69712 5.69665 1.25 11.2533 1.25C13.6597 1.25 15.9152 2.10339 17.6799 3.60158V3.09158C17.6799 2.41104 18.2041 1.88545 18.8846 1.88545C19.5651 1.88545 20.0907 2.41104 20.0907 3.09158V6.80227C20.0907 7.48281 19.5651 8.0084 18.8846 8.0084H15.1739C14.4934 8.0084 13.9692 7.48281 13.9692 6.80227C13.9692 6.07538 14.4073 5.48974 15.1739 5.48974H15.9046C14.5491 4.3955 12.8778 3.76866 11.1469 3.76866Z"/>\n</svg>\n</span><span class="${this.el.className}-text">重播</span>`}}const Me="preview-fullscreen-opened";class Ee extends A{constructor(e){super({className:"bmp-media-setting-button",clickHandler:()=>{}}),this.switchClickHandler=e,this.fullscreenDom=null,this.attachElement()}attachElement(){this.el.innerHTML=`\n      <span class="${this.el.className}-icon">\n<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M13.7485 5.49841C13.7485 6.46404 12.9657 7.24683 12.0001 7.24683C11.0344 7.24683 10.2516 6.46404 10.2516 5.49841C10.2516 4.53279 11.0344 3.75 12.0001 3.75C12.9657 3.75 13.7485 4.53279 13.7485 5.49841ZM13.7484 18.4982C13.7484 19.4639 12.9656 20.2467 11.9999 20.2467C11.0343 20.2467 10.2515 19.4639 10.2515 18.4982C10.2515 17.5326 11.0343 16.7498 11.9999 16.7498C12.9656 16.7498 13.7484 17.5326 13.7484 18.4982ZM11.9999 13.7487C12.9656 13.7487 13.7484 12.9658 13.7484 12.0002C13.7484 11.0345 12.9656 10.2517 11.9999 10.2517C11.0343 10.2517 10.2515 11.0345 10.2515 12.0002C10.2515 12.9658 11.0343 13.7487 11.9999 13.7487Z" fill="white"/>\n</svg>\n</span>\n      <div class="${this.el.className}-popup">\n        <span class="${this.el.className}-fullscreen-text">全屏预览</span>\n        <span class="${this.el.className}-fullscreen-icon">${J}</span>\n      </div>\n    `,this.fullscreenDom=this.el.querySelector(`.${this.el.className}-fullscreen-icon`),this.fullscreenDom.addEventListener("click",this.onFullScreenClick.bind(this))}onFullScreenClick(e){e.stopPropagation();const t=this.switchClickHandler();this.fullscreenDom.innerHTML=`${t?J:'\n<svg width="32" height="20" viewBox="0 0 32 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<rect width="32" height="20" rx="10" fill="#46494D"/>\n<g filter="url(#filter0_d_7938_315091)">\n<circle cx="10" cy="10" r="7" fill="white"/>\n</g>\n<defs>\n<filter id="filter0_d_7938_315091" x="1" y="2" width="18" height="18" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="1"/>\n<feGaussianBlur stdDeviation="1"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_7938_315091"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_7938_315091" result="shape"/>\n</filter>\n</defs>\n</svg>\n'}`}reset(){this.fullscreenDom.innerHTML=`${J}`}dispose(){this.fullscreenDom.removeEventListener("click",this.onFullScreenClick.bind(this))}}class Pe extends T{constructor(t){var i,n,s,r,a,p;super(),this.isVisible=!1,this.fullscreen=!0,this.playerContainer=new ie,this.watchLater=new ge,this.startButton=null,this.progressBar=null,this.guideTip=null,this.mediaEnd=null,this.likeButton=new ae((()=>e(this,void 0,void 0,(function*(){const t=!this.likeButton.state;_("click","preview_player.like.click",{mode:this.displayMode,type:"video",like_state:t?1:0});try{if(!(yield me()).isLogin)return ve(),!t;this.likeButton.setState(t);const s=l.getState();return yield(i=s.aid||0,n=t?1:2,e(void 0,void 0,void 0,(function*(){try{const e=new FormData;e.append("aid",String(i)),e.append("like",String(n)),e.append("csrf",he("bili_jct"));const t=yield window.fetch("//api.bilibili.com/x/web-interface/archive/like",{method:"POST",credentials:"include",body:e}),s=yield t.json();return 0===s.code||Promise.reject(s)}catch(e){return Promise.reject(e)}}))),d.emit("video-like",{aid:s.aid,state:t}),t}catch(e){return this.likeButton.setState(!t),Promise.reject(e)}var i,n})))),this.dmButton=new de({isVisible:l.getState().isDmVisible,clickHandler:()=>e(this,void 0,void 0,(function*(){try{_("click","preview_player.dm.click",{mode:this.displayMode,type:"video"});const e=!(yield this.playerContainer.isDmVisible());return yield this.playerContainer.setDmVisible(e),d.emit("dm-switch",{aid:l.getState().aid,state:e}),e}catch(e){return Promise.reject(e)}}))}),this.volumeButton=new pe((()=>e(this,void 0,void 0,(function*(){try{let e;e=!!(yield this.getRealVolume());const t=this.getLocalVolume();yield this.playerContainer.getVolume();return _("click","preview_player.volume.click",{mode:this.displayMode,type:"video",muted_state:e}),yield this.playerContainer.setMuted(e,t?!(null==t?void 0:t.nonzeroVol):e),yield this.playerContainer.setVolume(e?0:(null==t?void 0:t.nonzeroVol)||1),d.emit("volume-switch",{aid:l.getState().aid,state:!e}),e}catch(e){return Promise.reject(e)}})))),this.settingButton=new Ee((()=>(this.fullscreen=!this.fullscreen,this.setLocal(Me,`${Number(this.fullscreen)}`),_("click","preview_player.fullscreen.click",{mode:this.displayMode,type:"video",status:this.fullscreen}),this.fullscreen))),this.jumpButton=new ke((()=>{_("click","preview_player.jump.click",{mode:this.displayMode,type:"video"}),Z("video")})),this.replayButton=new Le((()=>{_("click","preview_player.replay.click",{mode:this.displayMode,type:"video"}),this.playerContainer.seekAutoPlay(0)})),this.removeEventListeners=()=>{},this.el.id="bili-video-preview",this.fullscreen=Boolean(Number(null!==(i=this.getLocal(Me))&&void 0!==i?i:1));const c=o.getState();this.displayMode=c.displayMode,"inline"===c.displayMode?(this.displayContainer=new ne("video"),this.closeButton=new se((()=>{this.hide(),d.emit("close",{aid:l.getState().aid})}))):(this.displayContainer=new oe("video"),this.closeButton=new re((()=>{this.hide(),d.emit("close",{aid:l.getState().aid})})),this.guideTip=new xe(null===(n=c.popupOptions)||void 0===n?void 0:n.guideTip),this.displayContainer.getElement().appendChild(this.guideTip.getElement()),this.displayContainer.mediaContainer.mediaPlayerPanel.getElement().appendChild(this.jumpButton.getElement()),(null===(r=null===(s=c.popupOptions)||void 0===s?void 0:s.setting)||void 0===r?void 0:r.disable)||this.displayContainer.getElement().appendChild(this.settingButton.getElement())),this.displayContainer.getElement().appendChild(this.closeButton.getElement()),this.el.appendChild(this.displayContainer.getElement()),this.mask=new O({scrollingElement:t,opacity:"popup"===c.displayMode?.7:.5,clickHandler:(null===(p=null===(a=c.popupOptions)||void 0===a?void 0:a.mask)||void 0===p?void 0:p.toggleClose)?()=>{this.hide(),d.emit("close",{aid:l.getState().aid})}:()=>{}}),this.el.appendChild(this.mask.getElement()),this.displayContainer.mediaContainer.getElement().appendChild(this.playerContainer.getElement()),this.displayContainer.mediaContainer.mediaPlayerPanel.getElement().appendChild(this.watchLater.getElement()),this.displayContainer.mediaContainer.mediaPlayerPanel.addCtrlButtonToPlayerCtrl(this.likeButton.getElement(),"right"),this.displayContainer.mediaContainer.mediaPlayerPanel.addCtrlButtonToPlayerCtrl(this.dmButton.getElement(),"right"),this.displayContainer.mediaContainer.mediaPlayerPanel.addCtrlButtonToPlayerCtrl(this.volumeButton.getElement(),"right"),this.displayContainer.mediaContainer.mediaProgress.getElement().appendChild(this.playerContainer.progressSlider.getElement());let h=null;this.displayContainer instanceof oe&&(this.progressBar=this.playerContainer.createProgressSlider(),this.displayContainer.mediaContainer.mediaPlayerPanel.addProgressBar(this.progressBar.getElement()),h=()=>e(this,void 0,void 0,(function*(){yield this.playerContainer.start(),_("click","preview_player.start.click",{mode:this.displayMode,type:"video"});const e=l.getState();d.emit("pause-switch",{aid:e.aid,state:"playing"!==e.status})})),this.startButton=new le(h),this.displayContainer.mediaContainer.mediaPlayerPanel.addCtrlButtonToPlayerCtrl(this.startButton.getElement(),"left")),this.removeEventListeners=C([{target:window,name:"keydown",listener:e=>{var t;if("Space"===e.code)null===(t=this.startButton)||void 0===t||t.handleClick()}}]),l.subscribe((e=>e.status),(e=>{var t,i;if("ended"===e)switch(this.displayMode){case"inline":this.hide();break;case"popup":this.attachMediaEndComponents(l.getState().cid),this.mediaEndHandler(!0)}else this.mediaEndHandler(!1);"playing"===e?null===(t=this.startButton)||void 0===t||t.toggle(!0):null===(i=this.startButton)||void 0===i||i.toggle(!1)})),l.subscribe((e=>e.progress),(e=>{e<l.getState().duration&&this.mediaEndHandler(!1)})),l.subscribe((e=>e.isDmVisible),(e=>{this.dmButton.setVisible(e)}))}attachMediaEndComponents(t){return e(this,void 0,void 0,(function*(){this.mediaEnd||(this.mediaEnd=new G,this.displayContainer.mediaContainer.getElement().appendChild(this.mediaEnd.getElement()),this.displayContainer.getElement().appendChild(this.replayButton.getElement()));const e=yield this.playerContainer.getBackDropBlobUrl(t);this.mediaEnd.setBackDrop(e)}))}mediaEndHandler(e){var t,i;e?(null===(t=this.mediaEnd)||void 0===t||t.show(),this.replayButton.show(),this.displayContainer.mediaDetails.hide()):(null===(i=this.mediaEnd)||void 0===i||i.hide(),this.replayButton.hide(),this.displayContainer.mediaDetails.show())}getLocalVolume(){let e=null;try{const t=JSON.parse(window.localStorage.getItem("bpx_player_profile"));e=null==t?void 0:t.media}catch(e){console.error(e)}return e}getLocal(e){try{return localStorage.getItem(e)}catch(e){return null}}setLocal(e,t){try{localStorage.setItem(e,t)}catch(e){}}getRealVolume(){return e(this,void 0,void 0,(function*(){const e=yield this.playerContainer.getMuted(),t=yield this.playerContainer.getVolume();return e?0:t}))}resetFullscreenStatus(){this.fullscreen=!0,this.setLocal(Me,"1"),this.settingButton.reset()}prepare(){return this.playerContainer.prepare()}display(t,i){var n,s,r,a;return e(this,void 0,void 0,(function*(){if(!this.isVisible)try{if(yield this.load(i),null===(n=this.guideTip)||void 0===n||n.show(),this.displayContainer.display(t,{bottom:(null===(s=this.guideTip)||void 0===s?void 0:s.visible)?95:0},{zoomInHanlder:(null===(a=null===(r=o.getState().popupOptions)||void 0===r?void 0:r.anime)||void 0===a?void 0:a.zoomOut)?()=>e(this,void 0,void 0,(function*(){var e;const t=yield this.playerContainer.requestAutoplay(!0);void 0!==(null==t?void 0:t.isMuted)&&this.volumeButton.setMuted(!!(null==t?void 0:t.isMuted)),void 0!==(null==t?void 0:t.isPaused)&&(null===(e=this.startButton)||void 0===e||e.toggle(!!(null==t?void 0:t.isPaused)),l.setState({status:(null==t?void 0:t.isPaused)?"paused":"playing"}))})):()=>{}}),this.mask.show(),_("appear","preview_player.all.show",{mode:this.displayMode,type:"video"}),this.isVisible=!0,"popup"===this.displayMode)switch(i.originAlt){case"CountClick":_("click","preview.tip.click",{mode:this.displayMode,type:"video"});break;case"ManualClick":_("click","preview.manual.click",{mode:this.displayMode,type:"video"})}}catch(e){return Promise.reject(e)}}))}resize(){var t;return e(this,void 0,void 0,(function*(){this.isVisible&&this.displayContainer.resize({bottom:(null===(t=this.guideTip)||void 0===t?void 0:t.visible)?95:0})}))}load(t){var i,n,s,r,a,d,p,c,h,u;return e(this,void 0,void 0,(function*(){try{yield ue(t),l.setState({aid:t.aid,bvid:t.bvid,cid:t.cid,ugcInfo:t.ugcInfo,spmIdFrom:t.spmIdFrom||""});const{ugcInfo:v,embedOptions:y}=t;if((m={bvid:t.bvid,aid:t.aid},e(void 0,void 0,void 0,(function*(){try{if(!(yield me()).isLogin)return!1;const e=yield window.fetch(k({url:"//api.bilibili.com/x/web-interface/archive/relation",query:{aid:m.aid,bvid:m.aid?void 0:m.bvid}}),{credentials:"include"}),t=yield e.json();return 0!==t.code?Promise.reject(t):t.data.like}catch(e){return Promise.reject(e)}}))).then((e=>{this.likeButton.setState(e)})),v&&(this.displayContainer.mediaDetails.setTitle(v.title),this.displayContainer.mediaDetails.setPubinfo({content:`${v.owner.name} · ${b(v.pubdate)}`,url:`//space.bilibili.com/${v.owner.mid}`}),this.displayContainer.mediaDetails.setStatinfo(`${v.enable_vt?v.stat.vt_display||g(v.stat.vt)+"分钟":g(v.stat.view)}播放 ${g(v.stat.danmaku)}弹幕`),this.displayContainer.mediaContainer.setTitle(v.title)),this.watchLater.refresh(t.aid||0),this.resetFullscreenStatus(),null==y?void 0:y.instance)return yield this.playerContainer.embed(y);yield this.playerContainer.load(t);const f=this.getLocalVolume();if(t.muted&&!f)null===(i=this.volumeButton)||void 0===i||i.setMuted(!0),this.playerContainer.setMuted(!0,!1);else{yield this.getRealVolume(),yield this.playerContainer.getVolume();const e=!!(f?!(null==f?void 0:f.volume):t.muted),i=!!(f?null==f?void 0:f.nonzeroVol:!t.muted);null===(n=this.volumeButton)||void 0===n||n.setMuted(e),this.playerContainer.setMuted(e,i)}if(t.initialTime&&(yield this.playerContainer.seek(t.initialTime)),null===(r=null===(s=o.getState().popupOptions)||void 0===s?void 0:s.anime)||void 0===r?void 0:r.zoomOut){if((()=>{if("undefined"==typeof window)return!1;const e=navigator.userAgent,t=e.indexOf("Chrome")<0&&e.indexOf("Safari")>-1,i=e.indexOf("Edge/")>-1;return!t&&!i})()){const e=yield this.playerContainer.getAheadDropBlobUrl(l.getState().cid);null===(d=null===(a=this.displayContainer.fakeMediaContainer)||void 0===a?void 0:a.setBackDrop)||void 0===d||d.call(a,null!==(p=null!=e?e:z(null==v?void 0:v.pic))&&void 0!==p?p:"")}else null===(h=null===(c=this.displayContainer.fakeMediaContainer)||void 0===c?void 0:c.setBackDrop)||void 0===h||h.call(c,null!==(u=z(null==v?void 0:v.pic))&&void 0!==u?u:"");return Promise.resolve()}return yield this.playerContainer.play()}catch(e){return Promise.reject(e)}var m}))}unload(){var e;this.playerContainer.close(),null===(e=this.startButton)||void 0===e||e.toggle(!0),this.volumeButton.setMuted(!0),this.dmButton.setVisible(!0)}hide(){var e,t;this.isVisible&&((null===(t=null===(e=o.getState().popupOptions)||void 0===e?void 0:e.anime)||void 0===t?void 0:t.zoomOut)?setTimeout((()=>{this.unload()}),10):this.unload(),this.displayContainer.hide(),this.mask.hide(),_("click","preview_player.close.click",{mode:this.displayMode,type:"video"}),d.emit("hide",{aid:l.getState().aid}),this.isVisible=!1)}dispose(){var e,t,i,n,s;this.removeEventListeners(),this.watchLater.dispose(),this.likeButton.dispose(),this.dmButton.dispose(),this.volumeButton.dispose(),null===(e=this.progressBar)||void 0===e||e.dispose(),null===(t=this.startButton)||void 0===t||t.dispose(),this.displayContainer.dispose(),this.closeButton.unmount(),this.mask.dispose(),this.playerContainer.dispose(),null===(i=this.jumpButton)||void 0===i||i.dispose(),null===(n=this.mediaEnd)||void 0===n||n.dispose(),null===(s=this.replayButton)||void 0===s||s.dispose(),this.settingButton.dispose(),this.unmount()}}class Be extends T{constructor(e,t){super(),this.bus=d,this.events=[],this.observedItems=[],this.container=e;const i=o.getState();this.displayZIndex=i.displayZIndex,this.displayMode=i.displayMode,this.videoPreview=new Pe,this.container.appendChild(this.videoPreview.getElement()),this.on("view-details",(()=>{this.hide()})),this.removeEventListeners=C([{target:window,name:"resize",listener:()=>{"popup"===this.displayMode?this.resize():this.hide()}},{target:window,name:"keydown",listener:e=>{if("Escape"===e.code)this.hide()}}])}get fullscreenStatus(){return this.videoPreview.fullscreen}prepare(){return e(this,void 0,void 0,(function*(){if(!this.videoPreview)return Promise.reject(new Error("Unexpected handler call"));yield this.videoPreview.prepare()}))}createVideoPlayer(t){return e(this,void 0,void 0,(function*(){try{return yield P(t)}catch(e){return Promise.reject(e)}}))}display(t,i){return e(this,void 0,void 0,(function*(){try{const e=v(t);if(!e)return Promise.reject(new Error("Display target element error"));const{type:n,videoOptions:s,liveOptions:o,spmIdFrom:r}=i;"video"===n&&s&&(yield this.videoPreview.display(e,Object.assign(Object.assign({},s),{spmIdFrom:r})))}catch(e){return Promise.reject(e)}}))}resize(){this.videoPreview.resize()}hide(){this.videoPreview.hide()}observe(t,i){return e(this,void 0,void 0,(function*(){const e=v(t);if(!e)return Promise.reject(new Error("observe el error"));const n=()=>{this.display(e,i)},s=()=>{this.hide()};return e.addEventListener("mouseenter",n),e.addEventListener("mouseleave",s),this.observedItems.push({el:e,onMouseenter:n,onMouseleave:s}),()=>{this.unobserve(e)}}))}unobserve(e){if(!(e instanceof HTMLElement))return;const t=this.observedItems.findIndex((t=>t.el===e));if(t>-1){const{el:e,onMouseenter:i,onMouseleave:n}=this.observedItems.splice(t,1)[0];e.removeEventListener("mouseenter",i),e.removeEventListener("mouseleave",n)}}observeBatch(e){e.forEach((e=>{try{this.observe(e.el,e.previewOptions)}catch(t){console.warn("Observe Batch error item: ",e)}}))}dispose(){for(;this.observedItems.length;){const{el:e,onMouseenter:t,onMouseleave:i}=this.observedItems.shift();e.removeEventListener("mouseenter",t),e.removeEventListener("mouseleave",i)}for(;this.events.length;){const{event:e,listener:t}=this.events.shift();this.bus.off(e,t)}this.removeEventListeners(),this.videoPreview.dispose(),this.unmount()}on(e,t){this.bus.on(e,t),this.events.push({event:e,listener:t})}off(e,t){this.bus.off(e,t);const i=this.events.findIndex((i=>i.event===e&&i.listener===t));this.events.splice(i,1)}}const Se={launch:(t,i)=>e(void 0,void 0,void 0,(function*(){let e=v(t);e||(e=document.createElement("div"),e.id="media-preview",document.body.appendChild(e));const n=new Be(e,i);return yield n.prepare(),n})),configure(e){return e.displayZIndex&&o.setState({displayZIndex:e.displayZIndex}),e.displayMode&&o.setState({displayMode:e.displayMode}),e.popupOptions&&o.setState({popupOptions:e.popupOptions}),this}};return function(e,t){void 0===t&&(t={});var i=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===i&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}("/* ------------------------------------ containers css ----------------------------------- */\n.bmp-inline-container {\n  --bmp-inline-width: 379px;\n  --bmp-inline-border-radius: 8px;\n  --bmp-inline-top-position: 0;\n  --bmp-inline-horizontal-position: 0;\n  --bmp-inline-original-top-position: 0;\n  --bmp-inline-original-horizontal-position: 0;\n  --bmp-inline-initial-scale: scale(0.8);\n  position: fixed;\n  left: var(--bmp-inline-original-horizontal-position);\n  top: var(--bmp-inline-original-top-position);\n  width: var(--bmp-inline-width);\n  border-radius: var(--bmp-inline-border-radius);\n  transform: var(--bmp-inline-initial-scale);\n  background-color: #FFFFFF;\n  border: 1px solid #E3E5E7;\n  padding: 16px;\n  box-sizing: border-box;\n  box-shadow: 0px 0px 30px rgba(0, 0, 0, 0.1);\n  opacity: 0;\n  pointer-events: none;\n  transform-origin: top;\n  transition-duration: 400ms;\n  transition-timing-function: cubic-bezier(0.05, 0, 0, 1);\n  will-change: var(--bmp-inline-transition-property);\n  z-index: 1000;\n}\n.bmp-inline-container[enter] {\n  transition-property: opacity, transform;\n}\n.bmp-inline-container[active] {\n  pointer-events: auto;\n  transform: scale(1);\n  opacity: 1;\n  left: var(--bmp-inline-horizontal-position);\n  top: var(--bmp-inline-top-position);\n  transition-property: transform, opacity, left, top;\n}\n.bmp-inline-container[leave] {\n  transition-property: transform, opacity, left, top;\n}\n.bmp-inline-container .bmp-media-container {\n  position: relative;\n  padding-top: 56.25%;\n}\n.bmp-inline-container .bmp-media-container .bmp-media-progress-shadow {\n  height: 100%;\n  pointer-events: none;\n  height: 6px;\n}\n.bmp-inline-container .bmp-media-container .bmp-media-progress-shadow .bmp-video-progress-track-bar {\n  overflow: hidden;\n  border-bottom-left-radius: 6px;\n  border-bottom-right-radius: 6px;\n}\n.bmp-inline-container .bmp-media-container .bmp-media-progress-shadow .bmp-video-progress-track-bar > div {\n  height: 3px;\n}\n.bmp-inline-container .bmp-media-details {\n  margin-top: 12px;\n}\n.bmp-inline-container .bmp-media-details .bmp-media-title {\n  height: 42px;\n  color: #18191C;\n}\n.bmp-inline-container .bmp-media-details .bmp-media-info-stat {\n  margin-top: 3px;\n}\n.bmp-inline-container .bmp-media-player-panel .bmp-watch-later {\n  right: 10px;\n  top: 10px;\n}\n.bmp-inline-container .bmp-media-player-panel .bmp-media-player-ctrl {\n  padding: 0 4px 4px;\n  height: 66.66%;\n  background: linear-gradient(180deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.6) 100%);\n  border-radius: 0px 0px 6px 6px;\n}\n.bmp-inline-container .bmp-media-player-panel .bmp-media-player-ctrl .bmp-media-ctrl-button {\n  margin-top: auto;\n  margin-left: 7px;\n}\n.bmp-inline-container .bmp-close-button {\n  right: 0;\n  top: -1px;\n  transform: translateX(calc(100% + 10px));\n  width: 28px;\n  height: 28px;\n  background: #FFFFFF;\n  border: 1px solid #E3E5E7;\n  box-shadow: 0px 0px 30px rgba(0, 0, 0, 0.1);\n}\n.bmp-inline-container .bmp-close-button svg {\n  width: 12px;\n  height: 12px;\n  color: #18191C;\n}\n.bmp-popup-container {\n  --bmp-popup-top-position: 0;\n  --bmp-popup-horizontal-position: 0;\n  --bmp-popup-width: 1104px;\n  --bmp-popup-height: 621px;\n  --bmp-popup-border-radius: 10px;\n  --bmp-popup-init-top-position: 0;\n  --bmp-popup-init-horizontal-position: 0;\n  --bmp-popup-init-width: 1104px;\n  --bmp-popup-init-height: 621px;\n  position: fixed;\n  left: var(--bmp-popup-horizontal-position);\n  top: var(--bmp-popup-top-position);\n  width: var(--bmp-popup-width);\n  height: var(--bmp-popup-height);\n  border-radius: var(--bmp-popup-border-radius);\n  box-sizing: border-box;\n  opacity: 0;\n  pointer-events: none;\n  transition-property: opacity;\n  transition-duration: 400ms;\n  transition-timing-function: cubic-bezier(0.05, 0, 0, 1);\n  z-index: 1000;\n}\n.bmp-popup-container[active] {\n  pointer-events: auto;\n  opacity: 1;\n}\n.bmp-popup-container .bmp-media-container {\n  z-index: 1;\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  border-radius: var(--bmp-popup-border-radius);\n  overflow: hidden;\n  isolation: isolate;\n}\n.bmp-popup-container .bmp-media-container .bmp-media-progress-shadow {\n  transition: opacity 300ms;\n  height: 4px;\n}\n.bmp-popup-container .bmp-media-container.zoom-anime {\n  opacity: 0;\n  transition-property: opacity;\n  transition-duration: 400ms;\n  transition-delay: 200ms;\n  transition-timing-function: cubic-bezier(0.05, 0, 0, 1);\n}\n.bmp-popup-container .bmp-media-container[active] {\n  transition-delay: 0ms;\n  opacity: 1;\n}\n.bmp-popup-container .bmp-fake-media-container {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  border-radius: var(--bmp-popup-border-radius);\n  opacity: 0;\n  transition-property: opacity;\n  transition-duration: 400ms;\n  transition-timing-function: cubic-bezier(0.05, 0, 0, 1);\n  pointer-events: none;\n  overflow: hidden;\n  isolation: isolate;\n  background-position: 50%;\n  background-size: contain;\n  background-repeat: no-repeat;\n  background-color: #000000;\n}\n.bmp-popup-container .bmp-fake-media-container[active] {\n  pointer-events: auto;\n  opacity: 1;\n}\n@keyframes zoomin_fake_container_1 {\n  0% {\n    left: var(--bmp-popup-init-horizontal-position);\n    top: var(--bmp-popup-init-top-position);\n    width: var(--bmp-popup-init-width);\n    height: var(--bmp-popup-init-height);\n  }\n  100% {\n    left: 0px;\n    top: 0px;\n    width: var(--bmp-popup-width);\n    height: var(--bmp-popup-height);\n  }\n}\n@keyframes zoomin_fake_container_2 {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n.bmp-popup-container .bmp-fake-media-container[zoom-in-anime] {\n  animation: zoomin_fake_container_1 0.4s ease 0.3s 1 normal both running, zoomin_fake_container_2 0.3s ease 0s 1 normal both running;\n}\n.bmp-popup-container .bmp-fake-media-container[zoom-out-anime] {\n  animation: zoomin_fake_container_1 0.4s ease 0s 1 reverse both running, zoomin_fake_container_2 0.3s ease 0.4s 1 reverse both running;\n}\n.bmp-popup-container:hover .bmp-media-details,\n.bmp-popup-container:hover .bmp-media-setting-button {\n  opacity: 1;\n}\n.bmp-popup-container:hover .bmp-media-progress-shadow {\n  opacity: 0;\n}\n.bmp-popup-container .bmp-media-details {\n  border-top-left-radius: var(--bmp-popup-border-radius);\n  border-top-right-radius: var(--bmp-popup-border-radius);\n  width: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  opacity: 0;\n  z-index: 13;\n  height: 150px;\n  padding: 24px;\n  box-sizing: border-box;\n  background: linear-gradient(0deg, rgba(0, 0, 0, 0) 2.18%, #000000 100%);\n  transition: opacity 300ms;\n  pointer-events: none;\n}\n.bmp-popup-container .bmp-media-details .bmp-media-title {\n  color: #FFFFFF;\n}\n.bmp-popup-container .bmp-media-details .bmp-media-info {\n  display: flex;\n  flex-direction: row-reverse;\n}\n.bmp-popup-container .bmp-media-details .bmp-media-info-pub {\n  margin-right: auto;\n}\n.bmp-popup-container .bmp-media-details .bmp-media-info-stat {\n  margin-right: 12px;\n}\n.bmp-popup-container .bmp-media-player-panel {\n  border-radius: var(--bmp-popup-border-radius);\n}\n.bmp-popup-container .bmp-media-player-panel .bmp-watch-later {\n  display: none;\n}\n.bmp-popup-container .bmp-media-player-panel .bmp-media-player-ctrl {\n  padding: 0 12px 9px 20px;\n  height: 16.66%;\n  background: linear-gradient(180deg, rgba(0, 0, 0, 0) 2.18%, #000000 100%);\n  border-radius: 0px 0px 10px 10px;\n}\n.bmp-popup-container .bmp-media-player-panel .bmp-media-player-ctrl .bpm-media-start-button {\n  margin-top: auto;\n  margin-bottom: 7px;\n  margin-right: 13px;\n}\n.bmp-popup-container .bmp-media-player-panel .bmp-media-player-ctrl-center {\n  margin-top: auto;\n  width: 100%;\n}\n.bmp-popup-container .bmp-media-player-panel .bmp-media-player-ctrl-center .bmp-video-progress-slider {\n  padding: 18px 0;\n}\n.bmp-popup-container .bmp-media-player-panel .bmp-media-player-ctrl-center .bmp-video-progress-slider .bmp-video-progress-track {\n  background-color: rgba(255, 255, 255, 0.396456);\n  height: 2px !important;\n  top: 50%;\n  transform: translateY(-50%);\n}\n.bmp-popup-container .bmp-media-player-panel .bmp-media-player-ctrl .bmp-media-ctrl-button {\n  margin-top: auto;\n  margin-left: 7px;\n}\n.bmp-popup-container .bmp-close-button {\n  right: 0;\n  top: -1px;\n  border-radius: 50%;\n  transform: translateX(calc(100% + 18px));\n  width: 42px;\n  height: 42px;\n  background: #000000;\n}\n.bmp-popup-container .bmp-close-button svg {\n  width: 32px;\n  height: 32px;\n  color: #FFFFFF;\n}\n.bmp-popup-container[zooming] {\n  transition: none;\n  pointer-events: none;\n}\n.bmp-popup-container[zooming] .bmp-media-details,\n.bmp-popup-container[zooming] .bmp-media-setting-button {\n  opacity: 0!important;\n}\n.bmp-popup-container[zooming] .bmp-media-progress-shadow {\n  opacity: 1!important;\n}\n.bmp-popup-container[zooming] .bmp-media-container {\n  cursor: default;\n}\n.bmp-popup-container[zooming] .bmp-media-container:hover .bmp-media-player-panel {\n  pointer-events: none;\n}\n@keyframes zoomin_closebtn {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n@keyframes zoomin_guidetip {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n.bmp-popup-container[zoom-in-anime] .bmp-close-button {\n  animation: zoomin_closebtn 0.2s ease 0.3s 1 normal both running;\n}\n.bmp-popup-container[zoom-in-anime] .bmp-guide-tip {\n  animation: zoomin_guidetip 0.4s ease 0.3s 1 normal both running;\n}\n.bmp-popup-container[zoom-out-anime] .bmp-close-button {\n  animation: zoomin_closebtn 0.2s ease 0s 1 reverse both running;\n}\n.bmp-popup-container[zoom-out-anime] .bmp-guide-tip {\n  animation: zoomin_guidetip 0.4s ease 0s 1 reverse both running;\n}\n/* -------------------------------- mask css -------------------------------- */\n.bmp-mask {\n  position: fixed;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  opacity: 0;\n  background-color: #000;\n  pointer-events: none;\n  transition-property: opacity;\n  transition-duration: 400ms;\n}\n.bmp-mask[active] {\n  pointer-events: auto;\n  opacity: 0.7;\n}\n@keyframes zoomin_mask {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 0.7;\n  }\n}\n.bmp-mask[zoom-in-anime] {\n  animation: zoomin_mask 0.4s ease 0.3s 1 normal both running;\n}\n.bmp-mask[zoom-out-anime] {\n  animation: zoomin_mask 0.4s ease 0s 1 reverse both running;\n}\n.bmp-mask[zooming] {\n  pointer-events: auto;\n}\n/* ------------------------------------ other css ----------------------------------- */\n.bmp-media-container {\n  cursor: pointer;\n}\n.bmp-media-container:hover .bmp-media-player-panel {\n  opacity: 1;\n  pointer-events: auto;\n}\n.bmp-media-cover img {\n  width: 100%;\n  height: 100%;\n}\n.bmp-media-cover,\n.bmp-media-player-container,\n.bmp-media-player-panel {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  pointer-events: none;\n  border-radius: 6px;\n}\n.bmp-media-player-container {\n  overflow: hidden;\n}\n.bmp-media-progress-shadow {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  z-index: 13;\n  width: 100%;\n}\n.bmp-video-progress-slider {\n  position: relative;\n  bottom: 0;\n  cursor: pointer;\n  width: 100%;\n  height: 100%;\n  pointer-events: auto;\n}\n.bmp-video-progress-slider:hover .bmp-video-progress-track-thumb-dot,\n.bmp-video-progress-slider:active .bmp-video-progress-track-thumb-dot {\n  transform: scale(1);\n  opacity: 1;\n}\n.bmp-video-progress-track,\n.bmp-video-progress-track-bar,\n.bmp-video-progress-track-bar-percent,\n.bmp-video-progress-track-bar-buffer {\n  position: absolute;\n  left: 0;\n  right: 0;\n  height: 100%;\n  bottom: 0;\n  transform-origin: 0 0;\n  will-change: transform;\n}\n.bmp-video-progress-track-bar-percent {\n  background-color: #00aeec;\n  transform: scaleX(0);\n}\n.bmp-video-progress-track-thumb {\n  pointer-events: none;\n  position: absolute;\n  left: 0;\n  bottom: 3px;\n  width: 16px;\n  height: 15px;\n  transform: translate(-50%, 50%);\n  z-index: 1;\n  will-change: left;\n}\n.bmp-video-progress-track-thumb-dot {\n  width: 16px;\n  height: 15px;\n  transform-origin: center;\n  opacity: 0;\n  transform: scale(0);\n  transition-duration: 0.3s;\n  transition-property: transform, opacity;\n  will-change: transform,opacity;\n}\n.bmp-video-progress-track-thumb-dot svg {\n  width: 16px;\n  height: 15px;\n  vertical-align: top;\n  line-height: unset;\n}\n.bmp-media-player-panel {\n  opacity: 0;\n  z-index: 14;\n  transition: opacity 300ms;\n}\n.bmp-media-player-ctrl {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  flex-direction: row;\n}\n.bmp-media-player-ctrl-left,\n.bmp-media-player-ctrl-right {\n  display: flex;\n  flex-direction: row;\n  flex-shrink: 0;\n}\n.bmp-media-player-ctrl-center {\n  flex: 1;\n}\n.bmp-close-button {\n  position: absolute;\n  border-radius: 50%;\n  box-sizing: border-box;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n}\n/* ------------------------------- widgets css ------------------------------ */\n.bmp-media-ctrl-button {\n  --bmp-ctrl-button-highlight-color: #00aeec;\n  width: 38px;\n  height: 38px;\n  color: white;\n  transition: color 0.3s;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.bmp-media-ctrl-button:hover {\n  color: var(--bmp-ctrl-button-highlight-color);\n}\n.bmp-media-ctrl-button svg {\n  width: 24px;\n  height: 24px;\n  pointer-events: none;\n  user-select: none;\n}\n.bmp-media-ctrl-button.like-button[active] {\n  color: var(--bmp-ctrl-button-highlight-color);\n}\n.bpm-media-start-button {\n  width: 22px;\n  height: 22px;\n}\n.bpm-media-start-button svg {\n  width: 22px;\n  height: 22px;\n  pointer-events: none;\n  user-select: none;\n}\n.watch-later-button {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 28px;\n  height: 28px;\n  border-radius: 6px;\n  cursor: pointer;\n  background-color: rgba(33, 33, 33, 0.8);\n  transform: translateZ(0);\n}\n.watch-later-button svg {\n  width: 22px;\n  height: 22px;\n}\n.bmp-tooltip {\n  pointer-events: none;\n  user-select: none;\n  position: absolute;\n  transform: translate(0px, 100%);\n  font-size: 12px;\n  color: #fff;\n  opacity: 0;\n  transition: opacity 0.2s linear;\n  will-change: opacity;\n  border-radius: 4px;\n  line-height: 18px;\n  padding: 4px 8px;\n  background-color: rgba(0, 0, 0, 0.8);\n  white-space: nowrap;\n}\n.bmp-tooltip.center {\n  right: auto;\n  left: 50%;\n  transform: translate(-50%, 100%);\n}\n.bmp-tooltip[visible] {\n  opacity: 1;\n}\n.bmp-watch-later {\n  position: absolute;\n}\n.bmp-watch-later .bmp-tooltip {\n  bottom: -6px;\n  right: -6px;\n}\n/* ------------------------------- details css ------------------------------ */\n.bmp-media-details {\n  display: flex;\n  flex-direction: column;\n  font-family: PingFang SC, HarmonyOS_Medium, Helvetica Neue, Microsoft YaHei, sans-serif;\n}\n.bmp-media-details a {\n  text-decoration: none;\n  cursor: pointer;\n  transition: color 0.2s linear;\n}\n.bmp-media-details a:hover {\n  color: #00AEEC !important;\n}\n.bmp-media-details .bmp-media-title {\n  padding-right: 16px;\n  font-size: 15px;\n  font-weight: 500;\n  line-height: 21px;\n  display: -webkit-box;\n  overflow: hidden;\n  -webkit-box-orient: vertical;\n  text-overflow: ellipsis;\n  word-break: break-word !important;\n  word-break: break-all;\n  line-break: anywhere;\n  -webkit-line-clamp: 2;\n}\n.bmp-media-details .bmp-media-info {\n  margin-top: 6px;\n}\n.bmp-media-details .bmp-media-info-pub,\n.bmp-media-details .bmp-media-info-stat {\n  font-weight: 400;\n  font-size: 13px;\n  line-height: 18px;\n  color: #9499A0;\n}\n.bmp-link-button {\n  cursor: pointer;\n  transition: color 0.2s linear;\n}\n.bmp-link-button:hover {\n  color: #00AEEC !important;\n}\n/* ------------------------------- guide-tip css ------------------------------ */\n.bmp-guide-tip {\n  display: flex;\n  align-items: center;\n  position: absolute;\n  bottom: -95px;\n  left: 50%;\n  padding-right: 21px;\n  height: 75px;\n  transform: translateX(-50%);\n  color: #fff;\n  border-radius: 8px;\n  background: linear-gradient(90.89deg, #42cdff 2.69%, #00aeec 89.82%);\n}\n.bmp-guide-tip > svg {\n  margin-left: -3px;\n  margin-right: 10px;\n}\n.bmp-guide-tip .bmp-guide-tip-header {\n  margin-bottom: 2px;\n  font-size: 15px;\n  font-weight: bold;\n  line-height: 18px;\n}\n.bmp-guide-tip .bmp-guide-tip-info {\n  font-size: 13px;\n  opacity: 0.9;\n  white-space: nowrap;\n}\n.bmp-guide-tip .bmp-guide-tip-btn {\n  margin-left: 33px;\n  width: 100px;\n  font-size: 14px;\n  font-weight: bold;\n  line-height: 34px;\n  text-align: center;\n  color: #00aeec;\n  background: #fff;\n  border-radius: 6px;\n  cursor: pointer;\n}\n/* ------------------------------- jump button css ------------------------------ */\n.bpm-jump-button {\n  width: 118px;\n  height: 32px;\n  line-height: 32px;\n  position: absolute;\n  bottom: 16.66%;\n  left: 50%;\n  margin-left: -59px;\n  color: #fff;\n  fill: #fff;\n  text-align: center;\n  border-radius: 26px;\n  background-color: rgba(24, 25, 28, 0.6);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  transition: all 0.3s;\n}\n.bpm-jump-button-icon {\n  display: inline-flex;\n  width: 16px;\n  height: 16px;\n}\n.bpm-jump-button:hover {\n  color: #00aeec;\n  fill: #00aeec;\n}\n/* ------------------------------- media end css ------------------------------ */\n.bmp-media-end {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 13;\n  pointer-events: none;\n}\n.bmp-media-end-backdrop {\n  position: absolute;\n  top: -10%;\n  left: -10%;\n  width: 120%;\n  height: 120%;\n  background-position: 50%;\n  background-size: cover;\n  filter: blur(20px);\n  z-index: -1;\n}\n.bmp-media-end-backdrop:before {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  content: '';\n  background-color: rgba(0, 0, 0, 0.6);\n}\n.bmp-media-end-panel {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 1;\n}\n/* -------------------------------replay css ------------------------------ */\n.bmp-replay-button {\n  width: 50px;\n  height: 60px;\n  margin: auto;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  fill: #fff;\n  color: #A2A7AE;\n  transition: all 0.3s;\n  font-weight: 400;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  cursor: pointer;\n  z-index: 13;\n}\n.bmp-replay-button-icon {\n  display: inline-block;\n  margin-bottom: 8px;\n}\n.bmp-replay-button:hover {\n  color: #00AEEC;\n  fill: #00AEEC;\n}\n/* -------------------------------setting css ------------------------------ */\n.bmp-media-setting-button {\n  opacity: 0;\n  position: absolute;\n  right: 24px;\n  top: 24px;\n  width: 44px;\n  height: 44px;\n  border-radius: 6px;\n  pointer-events: all;\n  z-index: 14;\n  transition: all 0.3s;\n  background-color: rgba(0, 0, 0, 0.5);\n}\n.bmp-media-setting-button:hover {\n  background-color: rgba(255, 255, 255, 0.1);\n}\n.bmp-media-setting-button:hover .bmp-media-setting-button-popup {\n  opacity: 1;\n  visibility: visible;\n}\n.bmp-media-setting-button-icon {\n  display: inline-block;\n  padding: 10px 0 0 10px;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n}\n.bmp-media-setting-button-popup {\n  opacity: 0;\n  visibility: hidden;\n  position: absolute;\n  top: 53px;\n  background-color: #242628;\n  border: 1px solid #2F3134;\n  box-shadow: 0px 0px 30px rgba(0, 0, 0, 0.1);\n  border-radius: 6px;\n  width: 180px;\n  line-height: 64px;\n  height: 64px;\n  right: 0;\n  color: #A2A7AE;\n  font-size: 14px;\n  transition: all 0.3s;\n}\n.bmp-media-setting-button-fullscreen-text {\n  padding: 0 49px 0 27px;\n}\n.bmp-media-setting-button-fullscreen-icon {\n  cursor: pointer;\n}\n"),(()=>{if(u())return;if(!window.biliMediaPreview)return;const t=window.biliMediaPreviewPreset;h(t)&&((t.displayZIndex||t.displayMode)&&Se.configure({displayZIndex:t.displayZIndex,displayMode:t.displayMode,popupOptions:t.popupOptions}),t.autoLaunch&&c(t.windowAdoptedKeyField)&&setTimeout((()=>e(void 0,void 0,void 0,(function*(){const e=yield window.biliMediaPreview.launch();t.observeList&&e.observeBatch(t.observeList),window[t.windowAdoptedKeyField]=e,delete window.biliMediaPreview})))))})(),Se}));
